Note
Access to this page requires authorization. You can trysigning inorchanging directories.
Access to this page requires authorization. You can trychanging directories.
Design and architect Azure ExpressRoute for resiliency
Article
2024-07-16
6 contributors
In this article
Azure ExpressRoute is an essential hybrid connectivity service widely used for its low latency, resilience, high throughput private connectivity between your on-premises network and Azure workloads. It offers the ability to achieve reliability, resiliency, and disaster recovery in network connections between on-premises and Azure to ensure availability of business and mission-critical workloads. This capability also extends access to Azure resources in a scalable, and cost-effective way.

Network connections that are highly reliable, resilient, and available are fundamental to a well-structured system. Reliability consists of two principles:resiliencyandavailability. The goal of resiliency is to prevent failures and, in the event they do occur, to restore your applications to a fully operational state. The objective of availability is to provide consistent access to your application or workloads. It's important to proactively plan for reliability based on your business needs and application requirements.
Users of ExpressRoute rely on the availability and performance of edge sites, WAN, and availability zones to maintain their connectivity to Azure. However, these components or sites might experience failures due to various reasons, such as equipment malfunctioning, network disruptions, weather conditions, or natural disasters. Therefore, it's a joint responsibility between users and their cloud provider, when planning for reliability, resiliency, and availability.
Site resiliency for ExpressRoute
There are three ExpressRoute resiliency architectures that can be utilized to ensure high availability and resiliency in your network connections between on-premises and Azure. These architecture designs include:
Maximum resiliency
High resiliency
Standard resiliency
Maximum resiliency
The Maximum resiliency architecture in ExpressRoute is structured to eliminate any single point of failure within the Microsoft network path. This set up is achieved by configuring a pair of circuits across two distinct locations for site diversity with ExpressRoute. The objective of Maximum resiliency is to enhance reliability, resiliency, and availability, as a result ensuring the highest level of resilience for business and/or mission-critical workloads. For such operations, we recommend that you configure maximum resiliency. This architectural design is recommended as part of theWell Architected Frameworkunder the reliability pillar. The ExpressRoute engineering team developed aguided portal experienceto assist you in configuring maximum resiliency.

High resiliency
High resiliency, also referred to as ExpressRoute Metro, enables the use of multiple sites within the same metropolitan (Metro) area to connect your on-premises network through ExpressRoute to Azure. High resiliency offers site diversity by splitting a single circuit across two sites. The first connection is established at one site and the second connection at a different site. The objective of ExpressRoute Metro is to mitigate the effect of edge-sites isolation and failures by introducing capabilities to enable site diversity. Site diversity is achieved by using a single circuit across paired sites within a metropolitan city, which offers resiliency to failures between edge and region. ExpressRoute Metro provides a higher level of site resiliency than Standard resiliency, but not as much as Maximum resiliency. ExpressRoute Metro architecture can be used for business and mission-critical workloads within a region. For more information, seeExpressRoute Metro

Standard resiliency
Standard resiliency in ExpressRoute is a single circuit with two connections configured at a single site.â¯Built-in redundancy (Active-Active) is configured to facilitate failover across the two connections of the circuit. Today, ExpressRoute offers two connections at a single peering location. If a failure happens at this site, users might experience loss of connectivity to their Azure workloads. This configuration is also known assingle-homedas it represents users with an ExpressRoute circuit configured with only one peering location. This configuration is considered theleastresilient andnot recommendedfor business or mission-critical workloads because it doesn't provide site resiliency.

Zonal resiliency for ExpressRoute
Azure regionsare an integral part of your ExpressRoute design and resiliency strategy. These regions are geographical locations of data centers that host Azure services.â¯Regions are interconnected through a dedicated low-latency network and are designed to be highly available, fault-tolerant, and scalable.
Azure offers several features to ensure regional resiliency. One such feature isâ¯availability zones. Availability zones protect applications and data from data center failures by spanning across multiple physical locations within a region. Regionsâ¯andâ¯availability zonesâ¯are central to your application design and resiliency strategy. By utilizing availability zones, you can achieve higher availability and resilience in your deployments.â¯For more information, seeRegions & availability zones.
We recommend deploying yourExpressRoute Virtual Network Gatewaysas zone redundant across availability zones within a region. These availability zones are separate physical locations with independent infrastructure (power, cooling, and networking). The purpose is to protect your on-premises network connectivity to Azure from zone level failures.Zone-redundant ExpressRoute gatewaysprovide resiliency, scalability, and higher availability for accessing mission-critical services on Azure.
Equipment failures or disasters in regional and zonal data centers can affect ExpressRoute gateway deployments in virtual networks. If gateways aren't deployed as zone-redundant, such failures within an Azure data center can affect the ability for users to access their Azure workloads.
If you have an existing non-zone redundant ExpressRoute gateways, there's now the ability tomigrate to an availability zone enabled gateway.
Recommendations
The following are recommendations to ensure high availability, resiliency, and reliability in your ExpressRoute network architecture:
ExpressRoute circuit recommendations
ExpressRoute Gateway recommendations
Disaster recovery and high availability recommendations
Monitoring and alerting recommendations
ExpressRoute circuit recommendations
During the initial planning phase, it's crucial to determine whether to configure anExpressRoute circuitor anExpressRoute Directconnection. An ExpressRoute circuit allows a private dedicated connection into Azure with the assistance of a connectivity provider. ExpressRoute Direct enables the extension of an on-premises network directly into the Microsoft network at a peering location. It's also necessary to identify the bandwidth requirement and the circuit SKU type requirement to meet your business needs.
After deploying multi-site redundant ExpressRoute circuits withmaximum resiliency, it's essential to ensure that on-premises routes are advertised over the redundant circuits to fully utilize the benefits of multi-site redundancy.â¯To evaluate the resiliency and test the failover of redundant circuits and routes Learn more here.
To improve resiliency and availability, Microsoft recommends operating both connections of an ExpressRoute circuit inactive-active mode. By allowing two connections to operate in this mode, Microsoft load balances the network traffic across the connections on a per-flow basis.
For better resiliency, plan to establish multiple paths between the on-premises edge and the peering locations (provider/Microsoft edge locations). This configuration can be achieved by utilizing different services providers or by routing through another peering location from the on-premises network. For high availability, it's essential to maintain the redundancy of the ExpressRoute circuit throughout the end-to-end network architecture. This includes maintaining redundancy within your on-premises network and redundancy within your service provider. Ensuring redundancy in these parts of your architecture means you shouldn't have a single point of failure.
Enabling Bidirectional Forwarding Detection (BFD) over ExpressRoute can accelerate the link failure detection between the MSEE devices and the routers on which your ExpressRoute circuit is configured. Microsoft recommends configuring the Customer Premises Edge (CPE) devices with BFD. ExpressRoute can be configured over your edge routing devices or your Partner Edge routing devices. BFD is enabled by default on the MSEE devices on the Microsoft side.
ExpressRoute Gateway recommendations
Createzone-redundant Virtual Network Gatewaysfor greater resiliency and plan for Virtual Network Gateways in different regions for disaster recovery and high availability. When utilizing zone-redundant gateways, you can benefit from zone-resiliency for accessing your mission-critical and scalable services on Azure.
Theguided gateway migrationexperience facilitates your migration from a Non-Az-Enabled SKU to an Az-Enabled SKU gateway. This feature allows for the creation of an additional virtual network gateway within the same gateway subnet. During the migration process, Azure transfers the control plane and data path configurations from your existing gateway to the new one.
Disaster recovery and high availability recommendations
To maximize availability, both the customer and service provider segments on your ExpressRoute circuit should be architected for availability & resiliency. For Disaster Recovery, plan for scenarios such as regional service outages due to natural calamities. Implement a robust disaster recovery design for multiple circuits configured through different peering locations in different regions. To learn more, see:Designing for disaster recovery.
For disaster recovery planning, we recommend setting up ExpressRoute circuits in multiple peering locations and regions. ExpressRoute circuits can be created in the same metropolitan area or different metropolitan areas, and different service providers can be used for diverse paths through each circuit. Geo-redundant ExpressRoute circuits are utilized to create a robust backend network connectivity for disaster recovery. To learn more, seeDesigning for high availability.
Note
Using site-to-site VPN as a backup solution for ExpressRoute connectivity is not recommended when dealing with latency-sensitive, mission-critical, or bandwidth-intensive workloads. In such cases, it's advisable to design for disaster recovery with ExpressRoute multi-site resiliency to ensure maximum availability.
Virtual Network (VNet) Peering provides a more efficient and direct method, enabling Azure services to communicate across virtual networks without the need of a virtual network gateway, extra hops, or transit over the public internet. To establish connectivity between virtual networks, VNet peering should be implemented for the best performance possible. For more information, seeâ¯About Virtual Network Peeringandâ¯Manage VNet peering.
Monitoring and alerting recommendations
As a baseline, we recommend configuringNetwork Insightswithin Azure Monitor to view all ExpressRoute circuit metrics, including ExpressRoute Direct and Global Reach. Within the circuits card you can visualize topologies and dependencies for peerings, connections, and gateways. The insights available for circuits include availability, throughput, and packet drops.
ExpressRoute usesAzure Service Healthto notify you of planned and upcomingExpressRoute circuit maintenance. With Service Health, you can view planned and past maintenance in the Azure portal along with configuring alerts and notifications that best suit your needs. In Service Health, you can see Planned & Past maintenance. You can also set alerts within Service Health to be notified of upcoming maintenance.
Connection Monitoris a cloud-based network monitoring solution that monitors connectivity between Azure cloud deployments and on-premises locations (Branch offices, etc.). Connection Monitor is an agent-based solution.
Setup monitoringusing Azure Monitor for ExpressRoute Gateway availability, performance, and scalability. When you deploy an ExpressRoute gateway, Azure manages the compute and functions of your gateway. There are multiplegateway metricsavailable to you to better understand the performance of your gateway.
Feedback
Was this page helpful?
Additional resources