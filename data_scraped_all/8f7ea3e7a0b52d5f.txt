Note
Access to this page requires authorization. You can trysigning inorchanging directories.
Access to this page requires authorization. You can trychanging directories.
Deploy Azure Virtual Desktop
Article
2024-10-22
7 contributors
In this article
Important
The following features are currently in preview:
Azure Virtual Desktop on Azure Local for Azure Government and for Azure operated by 21Vianet (Azure in China).
Azure Virtual Desktop on Azure Local for Azure Government and for Azure operated by 21Vianet (Azure in China).
Host pools with a session host configuration.
Host pools with a session host configuration.
For legal terms that apply to Azure features that are in beta, in preview, or otherwise not yet released into general availability, seeSupplemental Terms of Use for Microsoft Azure Previews.
This article shows you how to deploy Azure Virtual Desktop on Azure, Azure Local, or Azure Extended Zones by using the Azure portal, the Azure CLI, or Azure PowerShell. To deploy Azure Virtual Desktop, you:
Create a host pool.
Create a workspace.
Create an application group.
Create session host virtual machines (VMs).
Enable diagnostic settings (optional).
Assign users or groups to the application group for users to get access to desktops and applications.
You can do all these tasks in a single process when using the Azure portal, but you can also do them separately.
When you create a host pool, you can choose one of twomanagement approaches:
Session host configuration(preview) is available for pooled host pools with session hosts on Azure. Azure Virtual Desktop manages the lifecycle of session hosts in a pooled host pool for you by using a combination of native features to provide an integrated and dynamic experience.
Session host configuration(preview) is available for pooled host pools with session hosts on Azure. Azure Virtual Desktop manages the lifecycle of session hosts in a pooled host pool for you by using a combination of native features to provide an integrated and dynamic experience.
Standardmanagement is available for pooled and personal host pools with session hosts on Azure or Azure Local. You manage creating, updating, and scaling session hosts in a host pool. If you want to use existing tools and processes, such as automated pipelines, custom scripts, or external partner solutions, you need to use the standard host pool management type.
Standardmanagement is available for pooled and personal host pools with session hosts on Azure or Azure Local. You manage creating, updating, and scaling session hosts in a host pool. If you want to use existing tools and processes, such as automated pipelines, custom scripts, or external partner solutions, you need to use the standard host pool management type.
For more information on the terminology used in this article, seeAzure Virtual Desktop terminology. For more information about the Azure Virtual Desktop service, seeAzure Virtual Desktop service architecture and resilience.
Tip
The process covered in this article is an in-depth and adaptable approach to deploying Azure Virtual Desktop. If you want to try Azure Virtual Desktop with a more simple approach to deploy a sample Windows 11 desktop, seeTutorial: Deploy a sample Azure Virtual Desktop infrastructure with a Windows 11 desktopor use thequickstart.
Select a button at the top of this article to choose between host pools using standard management or host pools using session host configuration to see the relevant documentation.
Prerequisites
Review thePrerequisites for Azure Virtual Desktopfor a general idea of what's required and supported, such as operating systems (OS), virtual networks, and identity providers. It also includes a list of thesupported Azure regionsin which you can deploy host pools, workspaces, and application groups. This list of regions is where themetadatafor the host pool can be stored. However, session hosts can be located in any Azure region. For more information about the types of data and locations, seeData locations for Azure Virtual Desktop.
For a general idea of what's required and supported, such as operating systems (OSs), virtual networks, and identity providers, reviewPrerequisites for Azure Virtual Desktop. That article also includes a list of thesupported Azure regionsin which you can deploy host pools, workspaces, and application groups. This list of regions is where themetadatafor the host pool can be stored. However, session hosts can be located in any Azure region and on-premises withAzure Local. For more information about the types of data and locations, seeData locations for Azure Virtual Desktop.
For more prerequisites, including role-based access control (RBAC) roles, select the relevant tab for your scenario.
Azure portal
Azure PowerShell
In addition to the general prerequisites, you need:
The Azure account you use to create a host pool must have the following built-in role-based access control (RBAC) roles or equivalent as a minimum on the resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create this first.Resource typeRBAC roleHost pool, workspace, and application groupDesktop Virtualization ContributorSession hosts (Azure)Virtual Machine ContributorFor ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
The Azure account you use to create a host pool must have the following built-in role-based access control (RBAC) roles or equivalent as a minimum on the resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create this first.
For ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
Assign the Azure Virtual Desktop service principal theDesktop Virtualization Virtual Machine Contributorrole-based access control (RBAC) role on the resource group or subscription with the host pools and session hosts you want to use with session host update. For more information, seeAssign Azure RBAC roles or Microsoft Entra roles to the Azure Virtual Desktop service principals.
Assign the Azure Virtual Desktop service principal theDesktop Virtualization Virtual Machine Contributorrole-based access control (RBAC) role on the resource group or subscription with the host pools and session hosts you want to use with session host update. For more information, seeAssign Azure RBAC roles or Microsoft Entra roles to the Azure Virtual Desktop service principals.
A key vault containing the secrets you want to use for your virtual machine local administrator account credentials and, if you're joining session hosts to an Active Directory domain, your domain join account credentials. You need one secret for each username and password.You need to provide the Azure Virtual Desktop service principal the ability to read the secrets. Your key vault can be configured to use either:The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.The key vault must allowAzure Resource Manager for template deployment.
A key vault containing the secrets you want to use for your virtual machine local administrator account credentials and, if you're joining session hosts to an Active Directory domain, your domain join account credentials. You need one secret for each username and password.
You need to provide the Azure Virtual Desktop service principal the ability to read the secrets. Your key vault can be configured to use either:The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.
You need to provide the Azure Virtual Desktop service principal the ability to read the secrets. Your key vault can be configured to use either:
The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.
The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.
An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.
An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.
The key vault must allowAzure Resource Manager for template deployment.
The key vault must allowAzure Resource Manager for template deployment.
An Active Directory domain that you can join session hosts to. Joining session hosts to Microsoft Entra ID isn't supported, but you can useMicrosoft Entra hybrid join.
An Active Directory domain that you can join session hosts to. Joining session hosts to Microsoft Entra ID isn't supported, but you can useMicrosoft Entra hybrid join.
Don't disableWindows Remote Management(WinRM) when creating session hosts using the Azure portal, asPowerShell DSCrequires it.
Don't disableWindows Remote Management(WinRM) when creating session hosts using the Azure portal, asPowerShell DSCrequires it.
In addition to the general prerequisites, you need:
The Azure account you use to create a host pool must have the following built-in role-based access control (RBAC) roles or equivalent as a minimum on the resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create this first.Resource typeRBAC roleHost pool, workspace, and application groupDesktop Virtualization ContributorSession hosts (Azure)Virtual Machine ContributorFor ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
The Azure account you use to create a host pool must have the following built-in role-based access control (RBAC) roles or equivalent as a minimum on the resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create this first.
For ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
Assign the Azure Virtual Desktop service principal theDesktop Virtualization Virtual Machine Contributorrole-based access control (RBAC) role on the resource group or subscription with the host pools and session hosts you want to use with session host update. For more information, seeAssign Azure RBAC roles or Microsoft Entra roles to the Azure Virtual Desktop service principals.
Assign the Azure Virtual Desktop service principal theDesktop Virtualization Virtual Machine Contributorrole-based access control (RBAC) role on the resource group or subscription with the host pools and session hosts you want to use with session host update. For more information, seeAssign Azure RBAC roles or Microsoft Entra roles to the Azure Virtual Desktop service principals.
A key vault containing the secrets you want to use for your virtual machine local administrator account credentials and, if you're joining session hosts to an Active Directory domain, your domain join account credentials. You need one secret for each username and password. The virtual machine local administrator password must meet thepassword requirements when creating a VM.You need to provide the Azure Virtual Desktop service principal the ability to read the secrets. Your key vault can be configured to use either:The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.The key vault must allowAzure Resource Manager for template deployment.
A key vault containing the secrets you want to use for your virtual machine local administrator account credentials and, if you're joining session hosts to an Active Directory domain, your domain join account credentials. You need one secret for each username and password. The virtual machine local administrator password must meet thepassword requirements when creating a VM.
You need to provide the Azure Virtual Desktop service principal the ability to read the secrets. Your key vault can be configured to use either:The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.
You need to provide the Azure Virtual Desktop service principal the ability to read the secrets. Your key vault can be configured to use either:
The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.
The Azure RBAC permission modelwith the custom role you created assigned to the Azure Virtual Desktop service principal.
An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.
An access policywith theGetsecret permission assigned to the Azure Virtual Desktop service principal.
The key vault must allowAzure Resource Manager for template deployment.
The key vault must allowAzure Resource Manager for template deployment.
Don't disableWindows Remote Management(WinRM) when creating session hosts using the Azure portal, asPowerShell DSCrequires it.
Don't disableWindows Remote Management(WinRM) when creating session hosts using the Azure portal, asPowerShell DSCrequires it.
If you want to use Azure PowerShell locally, seeUse Azure CLI and Azure PowerShell with Azure Virtual Desktopto make sure you have theAz.DesktopVirtualizationPowerShell module installed. Alternatively, use theAzure Cloud Shell.
If you want to use Azure PowerShell locally, seeUse Azure CLI and Azure PowerShell with Azure Virtual Desktopto make sure you have theAz.DesktopVirtualizationPowerShell module installed. Alternatively, use theAzure Cloud Shell.
Azure PowerShell cmdlets for Azure Virtual Desktop that support host pools with a session host configuration are in preview. You need to download and install thepreview version of the Az.DesktopVirtualization moduleto use these cmdlets, which are added in version 5.3.0.NoteYou can't use PowerShell to add session hosts to a host pool with a session host configuration. You need to use the Azure portal to specify the number of session hosts you want to add, then Azure Virtual Desktop automatically creates them based on the session host configuration.
Azure PowerShell cmdlets for Azure Virtual Desktop that support host pools with a session host configuration are in preview. You need to download and install thepreview version of the Az.DesktopVirtualization moduleto use these cmdlets, which are added in version 5.3.0.
Note
You can't use PowerShell to add session hosts to a host pool with a session host configuration. You need to use the Azure portal to specify the number of session hosts you want to add, then Azure Virtual Desktop automatically creates them based on the session host configuration.
Azure portal
Azure PowerShell
Azure CLI
The Azure account that you use must have the following built-in RBAC roles or equivalent as a minimum on a resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create the resource group first.Resource typeRBAC roleHost pool, workspace, and application groupDesktop Virtualization ContributorSession hosts (Azure and Azure Extended Zones)Virtual Machine ContributorSession hosts (Azure Local)Azure Stack HCI VM ContributorFor ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
The Azure account that you use must have the following built-in RBAC roles or equivalent as a minimum on a resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create the resource group first.
For ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
To assign users to the application group, you also needMicrosoft.Authorization/roleAssignments/writepermissions on the application group. Built-in RBAC roles that include this permission areUser Access AdministratorandOwner.
To assign users to the application group, you also needMicrosoft.Authorization/roleAssignments/writepermissions on the application group. Built-in RBAC roles that include this permission areUser Access AdministratorandOwner.
Microsoft.Authorization/roleAssignments/write
Don't disableWindows Remote Managementwhen you're creating session hosts by using the Azure portal, becausePowerShell DSCrequires it.
Don't disableWindows Remote Managementwhen you're creating session hosts by using the Azure portal, becausePowerShell DSCrequires it.
To add session hosts on Azure Local, you also need:AnAzure Local instance registered with Azure. Your Azure Local instances need to be running a minimum of version 23H2. For more information, seeAzure Stack HCI, version 23H2 deployment overview.Azure Arc VM managementis installed automatically.A stable connection to Azure from your on-premises network.At least one Windows OS image available on the instance. For more information, see how tocreate VM images by using Azure Marketplace images,use images in an Azure Storage account, anduse images in a local share.A logical network that you created on your Azure Local instance. DHCP logical networks or static logical networks with automatic IP allocation are supported. For more information, seeCreate logical networks for Azure Local.
To add session hosts on Azure Local, you also need:
AnAzure Local instance registered with Azure. Your Azure Local instances need to be running a minimum of version 23H2. For more information, seeAzure Stack HCI, version 23H2 deployment overview.Azure Arc VM managementis installed automatically.
AnAzure Local instance registered with Azure. Your Azure Local instances need to be running a minimum of version 23H2. For more information, seeAzure Stack HCI, version 23H2 deployment overview.Azure Arc VM managementis installed automatically.
A stable connection to Azure from your on-premises network.
A stable connection to Azure from your on-premises network.
At least one Windows OS image available on the instance. For more information, see how tocreate VM images by using Azure Marketplace images,use images in an Azure Storage account, anduse images in a local share.
At least one Windows OS image available on the instance. For more information, see how tocreate VM images by using Azure Marketplace images,use images in an Azure Storage account, anduse images in a local share.
A logical network that you created on your Azure Local instance. DHCP logical networks or static logical networks with automatic IP allocation are supported. For more information, seeCreate logical networks for Azure Local.
A logical network that you created on your Azure Local instance. DHCP logical networks or static logical networks with automatic IP allocation are supported. For more information, seeCreate logical networks for Azure Local.
To deploy session hosts toAzure Extended Zones, you also need:Your Azure subscription registered with the respective Azure Extended Zone. For more information, seeRequest access to an Azure Extended Zone.AnAzure load balancerwith an outbound rule on the virtual network to which you're deploying session hosts. You can use an existing load balancer or you create a new one when adding session hosts.
To deploy session hosts toAzure Extended Zones, you also need:
Your Azure subscription registered with the respective Azure Extended Zone. For more information, seeRequest access to an Azure Extended Zone.
Your Azure subscription registered with the respective Azure Extended Zone. For more information, seeRequest access to an Azure Extended Zone.
AnAzure load balancerwith an outbound rule on the virtual network to which you're deploying session hosts. You can use an existing load balancer or you create a new one when adding session hosts.
AnAzure load balancerwith an outbound rule on the virtual network to which you're deploying session hosts. You can use an existing load balancer or you create a new one when adding session hosts.
The Azure account that you use must have the following built-in RBAC roles or equivalent as a minimum on a resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create the resource group first.Resource typeRBAC roleHost pool, workspace, and application groupDesktop Virtualization ContributorSession hostsVirtual Machine ContributorFor ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
The Azure account that you use must have the following built-in RBAC roles or equivalent as a minimum on a resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create the resource group first.
For ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
If you want to use Azure PowerShell locally, seeUse the Azure CLI and Azure PowerShell with Azure Virtual Desktopto make sure you have theAz.DesktopVirtualizationAzure PowerShell module installed. Alternatively, useAzure Cloud Shell.
If you want to use Azure PowerShell locally, seeUse the Azure CLI and Azure PowerShell with Azure Virtual Desktopto make sure you have theAz.DesktopVirtualizationAzure PowerShell module installed. Alternatively, useAzure Cloud Shell.
Important
If you want to create Microsoft Entra joined session hosts, we only support this using theAADLoginForWindowsVM extension, which is added and configured automatically when using the Azure portal or ARM template with the Azure Virtual Desktop service.
AADLoginForWindows
The Azure account that you use must have the following built-in RBAC roles or equivalent as a minimum on a resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create the resource group first.Resource typeRBAC roleHost pool, workspace, and application groupDesktop Virtualization ContributorSession hostsVirtual Machine ContributorFor ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
The Azure account that you use must have the following built-in RBAC roles or equivalent as a minimum on a resource group or subscription to create the following resource types. If you want to assign the roles to a resource group, you need to create the resource group first.
For ongoing management of host pools, workspaces, and application groups, you can use more granular roles for each resource type. For more information, seeBuilt-in Azure RBAC roles for Azure Virtual Desktop.
If you want to use the Azure CLI locally, seeUse the Azure CLI and Azure PowerShell with Azure Virtual Desktopto make sure you have thedesktopvirtualizationAzure CLI extension installed. Alternatively, useAzure Cloud Shell.
If you want to use the Azure CLI locally, seeUse the Azure CLI and Azure PowerShell with Azure Virtual Desktopto make sure you have thedesktopvirtualizationAzure CLI extension installed. Alternatively, useAzure Cloud Shell.
Important
If you want to create Microsoft Entra joined session hosts, we only support this using theAADLoginForWindowsVM extension, which is added and configured automatically when using the Azure portal or ARM template with the Azure Virtual Desktop service.
AADLoginForWindows
Create a host pool with a session host configuration
To create a host pool with a session host configuration, select the relevant tab for your scenario and follow the steps.
Azure portal
Azure PowerShell
Here's how to create a host pool with a session host configuration using the Azure portal, which also creates a default session host management policy and default session host configuration. You can change the default session host management policy and session host configuration after deployment.
Sign in to theAzure portal.
Sign in to theAzure portal.
In the search bar, enterAzure Virtual Desktopand select the matching service entry.
In the search bar, enterAzure Virtual Desktopand select the matching service entry.
SelectHost pools, then selectCreate.
SelectHost pools, then selectCreate.
On theBasicstab, complete the following information:ParameterValue/DescriptionSubscriptionSelect the subscription you want to create the host pool in from the drop-down list.Resource groupSelect an existing resource group or selectCreate newand enter a name.Host pool nameEnter a name for the host pool, for examplehp01, up to 64 characters in length.LocationSelect the Azure region where you want to create your host pool.Validation environmentSelectYesto create a host pool that is used as avalidation environment.A validation environment is required during the preview.Preferred app group typeSelect the preferredapplication group typefor this host pool fromDesktoporRemoteApp. A Desktop application group is created automatically when using the Azure portal, with whichever application group type you set as the preferred.Host pool typeHost pool typePooledis automatically selected and is the only host pool type supported with a session host configuration.Use a session host configurationSelectYes.Once you complete this tab, selectNext: Session hosts.
On theBasicstab, complete the following information:
Once you complete this tab, selectNext: Session hosts.
On theSession hoststab, complete the following information, which is captured in a session host configuration and used to create session hosts.ParameterValue/DescriptionNumber of session hostsEnter the number of session hosts you want to create when creating the host pool. You can enter0to not create any session hosts at this point, but a session host configuration is still created with the values you specify for when you do create session hosts.You can deploy up to 500 session host VMs at this point if you wish (depending on yoursubscription quota), or you can add more later.For more information, seeAzure Virtual Desktop service limitsandVirtual Machines limits.Session host configurationResource groupAutomatically defaults to the resource group you chose your host pool to be in on theBasicstab, but you can also select an alternative from the drop-down list.Name prefixEnter a name for your session hosts, for examplehp01-sh.This value is used as the prefix for your session host VMs. Each session host has a suffix of a hyphen and then a sequential number added to the end, for examplehp01-sh-0.It can be a maximum of 10 characters and is used in the computer name in the operating system. The prefix and the suffix combined can be a maximum of 15 characters. Session host names must be unique.Virtual machine locationSelect the Azure region where to deploy your session host VMs. This region must be the same as your virtual network is in.Availability zonesSelect one or moreavailability zonesin which to deploy your virtual machines.Security typeSelect fromStandard,Trusted launch virtual machines, orConfidential virtual machines.- If you selectTrusted launch virtual machines, options forsecure bootandvTPMare automatically selected.- If you selectConfidential virtual machines, options forsecure boot,vTPM, andintegrity monitoringare automatically selected. You can't opt out of vTPM when using a confidential VM.Trusted launch virtual machinesis the default.ImageSelect the OS image you want to use from the list, or selectSee all imagesto see more, including any custom images you create and store as anAzure Compute Gallery shared imageor amanaged image.Virtual machine sizeSelect a SKU. If you want to use different SKU, selectChange size, then select from the list.OS disk typeSelect the disk type to use for your session hosts. We recommendPremium SSDfor production workloads.OS disk sizeSelect a size for the OS disk.If you enable hibernate, ensure the OS disk is large enough to store the contents of the memory in addition to the OS and other applications.Boot DiagnosticsSelect whether you want to enableboot diagnostics.Network and securityVirtual networkSelect your virtual network. An option to select a subnet appears.SubnetSelect a subnet from your virtual network.Network security group typeSelect whether you want to use a network security group (NSG).-Basiccreates a new NSG and you can specify public inbound ports.-Advancedenables you to select an existing NSG.You don't need to open inbound ports to connect to Azure Virtual Desktop. Learn more atUnderstanding Azure Virtual Desktop network connectivity.Domain to joinSelect which directory you would like to joinSelectActive Directory, then select the key vault that contains the secrets for the username and password for the domain join account.You can optionally specify a domain name and organizational unit path.Virtual Machine Administrator accountSelect the key vault and secret for the username and password for the local administrator account of the new session host VMs. The username and password must meetthe requirements for Windows VMs in Azure.Custom configurationCustom configuration script URLIf you want to run a PowerShell script during deployment you can enter the URL here.TipOnce you complete this tab, you can continue to optionally register the default desktop application group with a new or preexisting workspace from this host pool, and enable diagnostics settings by selectingNext: Workspace. Alternatively, if you want to create and configure these separately, selectNext: Review + createand go to step 9.
On theSession hoststab, complete the following information, which is captured in a session host configuration and used to create session hosts.
Tip
Once you complete this tab, you can continue to optionally register the default desktop application group with a new or preexisting workspace from this host pool, and enable diagnostics settings by selectingNext: Workspace. Alternatively, if you want to create and configure these separately, selectNext: Review + createand go to step 9.
Optional: On theWorkspacetab, if you want to create a workspace and register the default desktop application group from this host pool, complete the following information:ParameterValue/DescriptionRegister desktop app groupSelectYes. This registers the default desktop application group to the selected workspace.To this workspaceSelect an existing workspace from the list, or selectCreate newand enter a name, for examplews01.Once you complete this tab, selectNext: Advanced.
Optional: On theWorkspacetab, if you want to create a workspace and register the default desktop application group from this host pool, complete the following information:
Once you complete this tab, selectNext: Advanced.
Optional: On theAdvancedtab, if you want to enable diagnostics settings, complete the following information:ParameterValue/DescriptionEnable diagnostics settingsCheck the box.Choosing destination details to send logs toSelect one of the following destinations:- Send to Log Analytics workspace- Archive to storage account- Stream to an event hubOnce you complete this tab, selectNext: Tags.
Optional: On theAdvancedtab, if you want to enable diagnostics settings, complete the following information:
Once you complete this tab, selectNext: Tags.
Optional: On theTagstab, you can enter any name/value pairs you need, then selectNext: Review + create.
Optional: On theTagstab, you can enter any name/value pairs you need, then selectNext: Review + create.
On theReview + createtab, ensure validation passes and review the information that is during deployment.
On theReview + createtab, ensure validation passes and review the information that is during deployment.
SelectCreateto create the host pool.
SelectCreateto create the host pool.
Once the host pool is created, selectGo to resourceto go to the overview of your new host pool, then selectPropertiesto view its properties.
Once the host pool is created, selectGo to resourceto go to the overview of your new host pool, then selectPropertiesto view its properties.
Post deployment
If you also added session hosts to your host pool, there's some extra configuration you might need to do, which is covered in the following sections.
To ensure that your session hosts have licenses applied correctly, you need to do the following tasks:
If you have the correct licenses to run Azure Virtual Desktop workloads, you can apply a Windows or Windows Server license to your session hosts as part of Azure Virtual Desktop and run them without paying for a separate license. This license is automatically applied when you create session hosts by using the Azure Virtual Desktop service, but you might have to apply the license separately if you create session hosts outside Azure Virtual Desktop. For more information, seeApply a Windows license to session host virtual machines.
If you have the correct licenses to run Azure Virtual Desktop workloads, you can apply a Windows or Windows Server license to your session hosts as part of Azure Virtual Desktop and run them without paying for a separate license. This license is automatically applied when you create session hosts by using the Azure Virtual Desktop service, but you might have to apply the license separately if you create session hosts outside Azure Virtual Desktop. For more information, seeApply a Windows license to session host virtual machines.
If your session hosts are running a Windows Server OS, you also need to issue them a Remote Desktop Services (RDS) client access license (CAL) from an RDS license server. For more information, seeLicense your RDS deployment with client access licenses.
If your session hosts are running a Windows Server OS, you also need to issue them a Remote Desktop Services (RDS) client access license (CAL) from an RDS license server. For more information, seeLicense your RDS deployment with client access licenses.
For session hosts on Azure Local, you must license and activate the virtual machines before you use them with Azure Virtual Desktop. For activating VMs that use Windows 10 Enterprise multi-session, Windows 11 Enterprise multi-session, and Windows Server 2022 Datacenter: Azure Edition, useAzure verification for VMs. For all other OS images (such as Windows 10 Enterprise, Windows 11 Enterprise, and other editions of Windows Server), you should continue to use existing activation methods. For more information, seeActivate Windows Server VMs on Azure Local.
For session hosts on Azure Local, you must license and activate the virtual machines before you use them with Azure Virtual Desktop. For activating VMs that use Windows 10 Enterprise multi-session, Windows 11 Enterprise multi-session, and Windows Server 2022 Datacenter: Azure Edition, useAzure verification for VMs. For all other OS images (such as Windows 10 Enterprise, Windows 11 Enterprise, and other editions of Windows Server), you should continue to use existing activation methods. For more information, seeActivate Windows Server VMs on Azure Local.

For session hosts on Azure that are joined to Microsoft Entra ID, you also need to enable single sign-on or earlier authentication protocols, assign an RBAC role to users, and review your multifactor authentication policies so that users can sign in to the VMs. For more information, seeMicrosoft Entra joined session hosts.
Note
If you created a host pool, workspace, and registered the default desktop application group from this host pool in the same process, go to the sectionAssign users to an application groupand complete the rest of the article. A Desktop application group is created automatically when using the Azure portal, whichever application group type you set as the preferred.
If you created a host pool, workspace, and registered the default desktop application group from this host pool in the same process, go to the sectionAssign users to an application groupand complete the rest of the article. A Desktop application group is created automatically when using the Azure portal, whichever application group type you set as the preferred.
If you created a host pool and workspace in the same process, but didn't register the default desktop application group from this host pool, go to the sectionCreate an application groupand complete the rest of the article.
If you created a host pool and workspace in the same process, but didn't register the default desktop application group from this host pool, go to the sectionCreate an application groupand complete the rest of the article.
If you didn't create a workspace, continue to the next section and complete the rest of the article.
If you didn't create a workspace, continue to the next section and complete the rest of the article.
Here's how to create a host pool with a session host configuration, and a session host management policy using Azure PowerShell. You can change the session host configuration and session host management policy after deployment. Be sure to change the<placeholder>values for your own.
<placeholder>
Important
In the following examples, the propertyManagementType = 'Automated'is specified. This property is currently required to use a session host configuration and can't be changed after the host pool is created. This property is planned to be deprecated during the preview, allowing any host pool to manage using a session host configuration. Host pools created with the propertyManagementType = 'Automatedwill continue to work after this property is deprecated.
ManagementType = 'Automated'
ManagementType = 'Automated
OpenAzure Cloud Shellin the Azure portal with thePowerShellterminal type, or run PowerShell on your local device.If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.If you're using PowerShell locally, firstsign in with Azure PowerShell, and then make sure yourAzure context is set to the subscription that you want to use.
OpenAzure Cloud Shellin the Azure portal with thePowerShellterminal type, or run PowerShell on your local device.
If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.
If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.
If you're using PowerShell locally, firstsign in with Azure PowerShell, and then make sure yourAzure context is set to the subscription that you want to use.
If you're using PowerShell locally, firstsign in with Azure PowerShell, and then make sure yourAzure context is set to the subscription that you want to use.
Use theNew-AzWvdHostPoolcmdlet with the following example to create a host pool with a session host configuration using thebreadth-firstload-balancing algorithmandDesktopas the preferredapplication group type. More parameters are available; for more information, see theNew-AzWvdHostPool PowerShell reference.$parameters = @{
    Name = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    ManagementType = 'Automated'
    HostPoolType = 'Pooled'
    PreferredAppGroupType = 'Desktop'
    LoadBalancerType = 'BreadthFirst'
    MaxSessionLimit = '<value>'
    Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
Use theNew-AzWvdHostPoolcmdlet with the following example to create a host pool with a session host configuration using thebreadth-firstload-balancing algorithmandDesktopas the preferredapplication group type. More parameters are available; for more information, see theNew-AzWvdHostPool PowerShell reference.
New-AzWvdHostPool
$parameters = @{
    Name = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    ManagementType = 'Automated'
    HostPoolType = 'Pooled'
    PreferredAppGroupType = 'Desktop'
    LoadBalancerType = 'BreadthFirst'
    MaxSessionLimit = '<value>'
    Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
$parameters = @{
    Name = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    ManagementType = 'Automated'
    HostPoolType = 'Pooled'
    PreferredAppGroupType = 'Desktop'
    LoadBalancerType = 'BreadthFirst'
    MaxSessionLimit = '<value>'
    Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
You can view the properties of your new host pool by running the following command:Get-AzWvdHostPool -Name <Name> -ResourceGroupName <ResourceGroupName> | FL *
You can view the properties of your new host pool by running the following command:
Get-AzWvdHostPool -Name <Name> -ResourceGroupName <ResourceGroupName> | FL *
Get-AzWvdHostPool -Name <Name> -ResourceGroupName <ResourceGroupName> | FL *
Next you need to create a session host configuration using theNew-AzWvdSessionHostConfigurationcmdlet. Here are some examples:To create a session host configuration using theWindows 11 Enterprise multi-session, version 22H2marketplace image, join Microsoft Entra ID, and Premium SSD for the OS disk type, run the following command. For information about how to find the values for the Marketplace image, seeFind and use Azure Marketplace VM images with Azure PowerShell.$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Marketplace'
    MarketplaceInfoPublisher = 'MicrosoftWindowsDesktop'
    MarketplaceInfoOffer = 'Windows-11'
    MarketplaceInfoSku = 'win11-22h2-avd'
    MarketplaceInfoExactVersion = '<VersionNumber>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'AzureActiveDirectory'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parametersTo create a session host configuration using a custom image, join an Active Directory domain, and Premium SSD for the OS disk type, run the following command:$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Custom'
    CustomInfoResourceID  = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Compute/galleries/<GalleryName>/images/<ImageName>/versions/<ImageVersion>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'ActiveDirectory'
    ActiveDirectoryInfoDomainName = '<DomainName>'
    DomainCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    DomainCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parametersYou can view the configuration of your session host configuration by running the following command:$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdSessionHostConfiguration @parameters | FL *
Next you need to create a session host configuration using theNew-AzWvdSessionHostConfigurationcmdlet. Here are some examples:
New-AzWvdSessionHostConfiguration
To create a session host configuration using theWindows 11 Enterprise multi-session, version 22H2marketplace image, join Microsoft Entra ID, and Premium SSD for the OS disk type, run the following command. For information about how to find the values for the Marketplace image, seeFind and use Azure Marketplace VM images with Azure PowerShell.$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Marketplace'
    MarketplaceInfoPublisher = 'MicrosoftWindowsDesktop'
    MarketplaceInfoOffer = 'Windows-11'
    MarketplaceInfoSku = 'win11-22h2-avd'
    MarketplaceInfoExactVersion = '<VersionNumber>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'AzureActiveDirectory'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parameters
To create a session host configuration using theWindows 11 Enterprise multi-session, version 22H2marketplace image, join Microsoft Entra ID, and Premium SSD for the OS disk type, run the following command. For information about how to find the values for the Marketplace image, seeFind and use Azure Marketplace VM images with Azure PowerShell.
$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Marketplace'
    MarketplaceInfoPublisher = 'MicrosoftWindowsDesktop'
    MarketplaceInfoOffer = 'Windows-11'
    MarketplaceInfoSku = 'win11-22h2-avd'
    MarketplaceInfoExactVersion = '<VersionNumber>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'AzureActiveDirectory'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parameters
$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Marketplace'
    MarketplaceInfoPublisher = 'MicrosoftWindowsDesktop'
    MarketplaceInfoOffer = 'Windows-11'
    MarketplaceInfoSku = 'win11-22h2-avd'
    MarketplaceInfoExactVersion = '<VersionNumber>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'AzureActiveDirectory'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parameters
To create a session host configuration using a custom image, join an Active Directory domain, and Premium SSD for the OS disk type, run the following command:$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Custom'
    CustomInfoResourceID  = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Compute/galleries/<GalleryName>/images/<ImageName>/versions/<ImageVersion>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'ActiveDirectory'
    ActiveDirectoryInfoDomainName = '<DomainName>'
    DomainCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    DomainCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parameters
To create a session host configuration using a custom image, join an Active Directory domain, and Premium SSD for the OS disk type, run the following command:
$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Custom'
    CustomInfoResourceID  = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Compute/galleries/<GalleryName>/images/<ImageName>/versions/<ImageVersion>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'ActiveDirectory'
    ActiveDirectoryInfoDomainName = '<DomainName>'
    DomainCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    DomainCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parameters
$parameters = @{
    FriendlyName = '<FriendlyName>'
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    VMNamePrefix = '<Prefix>'
    VMLocation = '<AzureRegion>'
    ImageInfoType = 'Custom'
    CustomInfoResourceID  = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Compute/galleries/<GalleryName>/images/<ImageName>/versions/<ImageVersion>'
    VMSizeId = 'Standard_D8s_v5'
    DiskInfoType = 'Premium_LRS'
    NetworkInfoSubnetId = '/subscriptions/<SubscriptionID>/resourceGroups/<ResourceGroupName>/providers/Microsoft.Network/virtualNetworks/<VNetName>/subnets/<SubnetName>'
    DomainInfoJoinType = 'ActiveDirectory'
    ActiveDirectoryInfoDomainName = '<DomainName>'
    DomainCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    DomainCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsUsernameKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
    VMAdminCredentialsPasswordKeyVaultSecretUri = 'https://<VaultName>.vault.azure.net/secrets/<SecretName>/<Version>'
}

New-AzWvdSessionHostConfiguration @parameters
You can view the configuration of your session host configuration by running the following command:
You can view the configuration of your session host configuration by running the following command:
$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdSessionHostConfiguration @parameters | FL *
$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdSessionHostConfiguration @parameters | FL *
Finally, create a session host management policy using theNew-AzWvdSessionHostManagementcmdlet by running the following command. For valid time zone values, seeGet-TimeZone PowerShell referenceand use the value from theStandardNameproperty.$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    ScheduledDateTimeZone = '<TimeZone>'
    UpdateLogOffDelayMinute = '<Number>'
    UpdateMaxVmsRemoved = '<Number>'
    UpdateDeleteOriginalVM = $False
    UpdateLogOffMessage = '<Message>'
}

New-AzWvdSessionHostManagement @parameters
Finally, create a session host management policy using theNew-AzWvdSessionHostManagementcmdlet by running the following command. For valid time zone values, seeGet-TimeZone PowerShell referenceand use the value from theStandardNameproperty.
New-AzWvdSessionHostManagement
StandardName
$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    ScheduledDateTimeZone = '<TimeZone>'
    UpdateLogOffDelayMinute = '<Number>'
    UpdateMaxVmsRemoved = '<Number>'
    UpdateDeleteOriginalVM = $False
    UpdateLogOffMessage = '<Message>'
}

New-AzWvdSessionHostManagement @parameters
$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
    ScheduledDateTimeZone = '<TimeZone>'
    UpdateLogOffDelayMinute = '<Number>'
    UpdateMaxVmsRemoved = '<Number>'
    UpdateDeleteOriginalVM = $False
    UpdateLogOffMessage = '<Message>'
}

New-AzWvdSessionHostManagement @parameters
Create a host pool with standard management
To create a host pool, select the relevant tab for your scenario and follow the steps.
Azure portal
Azure PowerShell
Azure CLI
Here's how to create a host pool by using the Azure portal:
Sign in to theAzure portal.
Sign in to theAzure portal.
On the search bar, enterAzure Virtual Desktopand select the matching service entry.
On the search bar, enterAzure Virtual Desktopand select the matching service entry.
SelectHost pools, and then selectCreate.
SelectHost pools, and then selectCreate.
On theBasicstab, complete the following information:ParameterValue/DescriptionSubscriptionIn the dropdown list, select the subscription where you want to create the host pool.Resource groupSelect an existing resource group, or selectCreate newand enter a name.Host pool nameEnter a name for the host pool, such ashp01.LocationSelect the Azure region where you want to create your host pool.Validation environmentSelectYesto create a host pool that's used as avalidation environment.SelectNo(default) to create a host pool that isn't used as a validation environment.Preferred app group typeSelect thepreferred application group typefor this host pool:DesktoporRemoteApp. A desktop application group is created automatically when you use the Azure portal.Host pool typeSelect whether you want your host pool to bePooledorPersonal.If you selectPooled, two new options appear forLoad balancing algorithmandMax session limit.Expand this section for the pooled options.- ForLoad balancing algorithm, choose eitherbreadth-firstordepth-first, based on your usage pattern.- ForMax session limit, enter the maximum number of users that you want load-balanced to a single session host. For more information, seeHost pool load-balancing algorithms.If you selectPersonal, two new options appear forAssignment typeandAssign multiple desktops to a single user.Expand this section for the personal options.ForAssignment type, selectAutomaticfor the service to assign any personal desktop not already assigned to a user, or selectDirectto assign a specific personal desktop to a user. With theDirectassignment type you can also check the box toAssign multiple desktops to a single user. For more information, seeAssign multiple personal desktops to a single user.TipAfter you complete this tab, you can continue to optionally create session hosts, create a workspace, register the default desktop application group from this host pool, and enable diagnostic settings by selectingNext: Virtual Machines. Alternatively, if you want to create and configure these resources separately, selectNext: Review + createand go to step 9.
On theBasicstab, complete the following information:
Tip
After you complete this tab, you can continue to optionally create session hosts, create a workspace, register the default desktop application group from this host pool, and enable diagnostic settings by selectingNext: Virtual Machines. Alternatively, if you want to create and configure these resources separately, selectNext: Review + createand go to step 9.
Optional: On theVirtual machinestab, if you want to add session hosts, expand one of the following sections and complete the information, depending on whether you want to create session hosts on Azure or on Azure Local. For guidance on sizing session host virtual machines, seeSession host virtual machine sizing guidelines.To add session hosts onAzure, expand this section.ParameterValue/DescriptionAdd virtual machinesSelectYes. This action shows several new options.Resource groupThis value defaults to the resource group that you chose to contain your host pool on theBasicstab, but you can select an alternative.Name prefixEnter a name prefix for your session hosts, such ashp01-sh.Each session host has a suffix of a hyphen and then a sequential number added to the end, such ashp01-sh-0.This name prefix can be a maximum of 11 characters and is used in the computer name in the operating system. The prefix and the suffix combined can be a maximum of 15 characters. Session host names must be unique.Virtual machine typeSelectAzure virtual machine.Virtual machine locationSelect the Azure region where you want to deploy your session hosts. This value must be the same region that contains your virtual network.Availability optionsSelect fromavailability zones,availability set, orNo infrastructure redundancy required. If you selectavailability zonesoravailability set, complete the extra parameters that appear.Security typeSelect fromStandard,Trusted launch virtual machines, orConfidential virtual machines.- If you selectTrusted launch virtual machines, options forsecure bootandvTPMare automatically selected.- If you selectConfidential virtual machines, options forsecure boot,vTPM, andintegrity monitoringare automatically selected. You can't opt out of vTPM when using a confidential VM.ImageSelect the OS image that you want to use from the list, or selectSee all imagesto see more. The full list includes any images that you created and stored as anAzure Compute Gallery shared imageor amanaged image.Virtual machine sizeSelect a size. If you want to use a different size, selectChange size, and then select from the list.HibernateSelect the box to enable hibernation. Hibernation is available only for personal host pools. For more information, seeHibernation in virtual machines. If you're using Microsoft Teams media optimizations, you should update theWebRTC redirector service to 1.45.2310.13001.FSLogix and app attach currently don't support hibernation. Don't enable hibernation if you're using FSLogix or app attach for your personal host pools.Number of VMsEnter the number of virtual machines that you want to deploy. You can deploy up to 400 session hosts at this point if you want (depending on yoursubscription quota), or you can add more later.For more information, seeAzure Virtual Desktop service limitsandVirtual Machines limits.OS disk typeSelect the disk type to use for your session hosts. We recommend that you use onlyPremium SSDfor production workloads.OS disk sizeSelect a size for the OS disk.If you enable hibernation, ensure that the OS disk is large enough to store the contents of the memory in addition to the OS and other applications.Confidential computing encryptionIf you're using a confidential VM, you must select theConfidential compute encryptioncheckbox to enable OS disk encryption.This checkbox appears only if you selectedConfidential virtual machinesas your security type.Boot DiagnosticsSelect whether you want to enableboot diagnostics.Network and securityVirtual networkSelect your virtual network. An option to select a subnet appears.SubnetSelect a subnet from your virtual network.Network security groupSelect whether you want to use a network security group (NSG).-Nonedoesn't create a new NSG.-Basiccreates a new NSG for the VM network adapter.-Advancedenables you to select an existing NSG.We recommend that you don't create an NSG here, butcreate an NSG on the subnet instead.Public inbound portsYou can select a port to allow from the list. Azure Virtual Desktop doesn't require public inbound ports, so we recommend that you selectNo.Domain to joinSelect which directory you would like to joinSelect fromMicrosoft Entra IDorActive Directory, and complete the relevant parameters for the selected option.Virtual Machine Administrator accountUsernameEnter a name to use as the local administrator account for the new session hosts. For more information, seeWhat are the username requirements when creating a VM?PasswordEnter a password for the local administrator account. For more information, seeWhat are the password requirements when creating a VM?Confirm passwordReenter the password.Custom configurationCustom configuration script URLIf you want to run a PowerShell script during deployment, you can enter the URL here.To add session hosts onAzure Local, expand this section.ParameterValue/DescriptionAdd virtual machinesSelectYes. This action shows several new options.Resource groupThis value defaults to the resource group that you chose to contain your host pool on theBasicstab, but you can select an alternative.Name prefixEnter a name prefix for your session hosts, such ashp01-sh.Each session host has a suffix of a hyphen and then a sequential number added to the end, such ashp01-sh-0.This name prefix can be a maximum of 11 characters and is used in the computer name in the operating system. The prefix and the suffix combined can be a maximum of 15 characters. Session host names must be unique.Virtual machine typeSelectAzure Local.Custom locationIn the dropdown list, select the Azure Local instance where you want to deploy your session hosts.ImagesSelect the OS image that you want to use from the list, or selectManage VM imagesto manage the images available on the instance that you selected.Number of VMsEnter the number of virtual machines that you want to deploy. You can add more later.Virtual processor countEnter the number of virtual processors that you want to assign to each session host. This value isn't validated against the resources available in the instance.Memory typeSelectStaticfor a fixed memory allocation, or selectDynamicfor a dynamic memory allocation.Memory (GB)Enter a number for the amount of memory, in gigabytes, that you want to assign to each session host. This value isn't validated against the resources available in the instance.Maximum memoryIf you selected dynamic memory allocation, enter a number for the maximum amount of memory, in gigabytes, that you want your session host to be able to use.Minimum memoryIf you selected dynamic memory allocation, enter a number for the minimum amount of memory, in gigabytes, that you want your session host to be able to use.Network and securityNetwork dropdownSelect an existing network to connect each session to.Domain to joinSelect which directory you would like to joinActive Directoryis the only available option. This includes usingMicrosoft Entra hybrid join.AD domain join UPNEnter the user principal name (UPN) of an Active Directory user who has permission to join the session hosts to your domain.PasswordEnter the password for the Active Directory user.Specify domain or unitSelectyesif you want to join session hosts to a specific domain or be placed in a specific organizational unit (OU). If you selectno, the suffix of the UPN is used as the domain.Virtual Machine Administrator accountUsernameEnter a name to use as the local administrator account for the new session hosts. For more information, seeWhat are the username requirements when creating a VM?PasswordEnter a password for the local administrator account. For more information, seeWhat are the password requirements when creating a VM?Confirm passwordReenter the password.To add session hosts onAzure Extended Zones, expand this section.ParameterValue/DescriptionAdd virtual machinesSelectYes. This action shows several new options.Resource groupThis value defaults to the resource group that you chose to contain your host pool on theBasicstab, but you can select an alternative.Name prefixEnter a name prefix for your session hosts, such ashp01-sh.Each session host has a suffix of a hyphen and then a sequential number added to the end, such ashp01-sh-0.This name prefix can be a maximum of 11 characters and is used in the computer name in the operating system. The prefix and the suffix combined can be a maximum of 15 characters. Session host names must be unique.Virtual machine typeSelectAzure virtual machine.Virtual machine locationSelectDeploy to an Azure Extended Zone.Azure Extended ZoneSelect the Extended Zone you require.Network and securitySelect a load balancerSelect an existing Azure load balancer on the same virtual network you want to use for your session hosts, or selectCreate a load balancerto create a new load balancer.Select a backend poolSelect a backend pool on the load balancer you want to use for your session hosts. If you're creating a new load balancer, selectCreate newto create a new backend pool for the new load balancer.Add outbound ruleIf you're creating a new load balancer, selectCreate newto create a new outbound rule for it.After you complete this tab, selectNext: Workspace.
Optional: On theVirtual machinestab, if you want to add session hosts, expand one of the following sections and complete the information, depending on whether you want to create session hosts on Azure or on Azure Local. For guidance on sizing session host virtual machines, seeSession host virtual machine sizing guidelines.
After you complete this tab, selectNext: Workspace.
Optional: On theWorkspacetab, if you want to create a workspace and register the default desktop application group from this host pool, complete the following information:ParameterValue/DescriptionRegister desktop app groupSelectYes. This action registers the default desktop application group to the selected workspace.To this workspaceSelect an existing workspace from the list, or selectCreate newand enter a name, such asws01.After you complete this tab, selectNext: Advanced.
Optional: On theWorkspacetab, if you want to create a workspace and register the default desktop application group from this host pool, complete the following information:
After you complete this tab, selectNext: Advanced.
Optional: On theAdvancedtab, if you want to enable diagnostic settings, complete the following information:ParameterValue/DescriptionEnable diagnostics settingsSelect the box.Choosing destination details to send logs toSelect one of the following destinations:- Send to a Log Analytics workspace- Archive to a storage account- Stream to an event hubAfter you complete this tab, selectNext: Tags.
Optional: On theAdvancedtab, if you want to enable diagnostic settings, complete the following information:
After you complete this tab, selectNext: Tags.
Optional: On theTagstab, you can enter any name/value pairs that you need, and then selectNext: Review + create.
Optional: On theTagstab, you can enter any name/value pairs that you need, and then selectNext: Review + create.
On theReview + createtab, ensure that validation passes and review the information that will be used during deployment.
On theReview + createtab, ensure that validation passes and review the information that will be used during deployment.
SelectCreateto create the host pool.
SelectCreateto create the host pool.
Once the deployment has completed successfully, selectGo to resourceto go to the overview of your new host pool, and then selectPropertiesto view its properties.
Once the deployment has completed successfully, selectGo to resourceto go to the overview of your new host pool, and then selectPropertiesto view its properties.
Post-deployment tasks
If you also added session hosts to your host pool, you need to do some extra configuration, as described in the following sections.
To ensure that your session hosts have licenses applied correctly, you need to do the following tasks:
If you have the correct licenses to run Azure Virtual Desktop workloads, you can apply a Windows or Windows Server license to your session hosts as part of Azure Virtual Desktop and run them without paying for a separate license. This license is automatically applied when you create session hosts by using the Azure Virtual Desktop service, but you might have to apply the license separately if you create session hosts outside Azure Virtual Desktop. For more information, seeApply a Windows license to session host virtual machines.
If you have the correct licenses to run Azure Virtual Desktop workloads, you can apply a Windows or Windows Server license to your session hosts as part of Azure Virtual Desktop and run them without paying for a separate license. This license is automatically applied when you create session hosts by using the Azure Virtual Desktop service, but you might have to apply the license separately if you create session hosts outside Azure Virtual Desktop. For more information, seeApply a Windows license to session host virtual machines.
If your session hosts are running a Windows Server OS, you also need to issue them a Remote Desktop Services (RDS) client access license (CAL) from an RDS license server. For more information, seeLicense your RDS deployment with client access licenses.
If your session hosts are running a Windows Server OS, you also need to issue them a Remote Desktop Services (RDS) client access license (CAL) from an RDS license server. For more information, seeLicense your RDS deployment with client access licenses.
For session hosts on Azure Local, you must license and activate the virtual machines before you use them with Azure Virtual Desktop. For activating VMs that use Windows 10 Enterprise multi-session, Windows 11 Enterprise multi-session, and Windows Server 2022 Datacenter: Azure Edition, useAzure verification for VMs. For all other OS images (such as Windows 10 Enterprise, Windows 11 Enterprise, and other editions of Windows Server), you should continue to use existing activation methods. For more information, seeActivate Windows Server VMs on Azure Local.
For session hosts on Azure Local, you must license and activate the virtual machines before you use them with Azure Virtual Desktop. For activating VMs that use Windows 10 Enterprise multi-session, Windows 11 Enterprise multi-session, and Windows Server 2022 Datacenter: Azure Edition, useAzure verification for VMs. For all other OS images (such as Windows 10 Enterprise, Windows 11 Enterprise, and other editions of Windows Server), you should continue to use existing activation methods. For more information, seeActivate Windows Server VMs on Azure Local.

For session hosts on Azure that are joined to Microsoft Entra ID, you also need to enable single sign-on or earlier authentication protocols, assign an RBAC role to users, and review your multifactor authentication policies so that users can sign in to the VMs. For more information, seeMicrosoft Entra joined session hosts.
Note
If you created a host pool and a workspace, and you registered the default desktop application group from this host pool in the same process, go to the sectionAssign users to an application groupand complete the rest of the article. A desktop application group (whichever application group type you set as preferred) is created automatically when you use the Azure portal.
If you created a host pool and a workspace, and you registered the default desktop application group from this host pool in the same process, go to the sectionAssign users to an application groupand complete the rest of the article. A desktop application group (whichever application group type you set as preferred) is created automatically when you use the Azure portal.
If you created a host pool and workspace in the same process, but you didn't register the default desktop application group from this host pool, go to the sectionCreate an application groupand complete the rest of the article.
If you created a host pool and workspace in the same process, but you didn't register the default desktop application group from this host pool, go to the sectionCreate an application groupand complete the rest of the article.
If you didn't create a workspace, continue to the next section and complete the rest of the article.
If you didn't create a workspace, continue to the next section and complete the rest of the article.
Here's how to create a host pool by using theAz.DesktopVirtualizationAzure PowerShell module. The following examples show you how to create a pooled host pool and a personal host pool. Be sure to change the<placeholder>values for your own.
<placeholder>
OpenAzure Cloud Shellin the Azure portal with thePowerShellterminal type, or run PowerShell on your local device.If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.If you're using PowerShell locally, firstsign in with Azure PowerShell, and then make sure yourAzure context is set to the subscription that you want to use.
OpenAzure Cloud Shellin the Azure portal with thePowerShellterminal type, or run PowerShell on your local device.
If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.
If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.
If you're using PowerShell locally, firstsign in with Azure PowerShell, and then make sure yourAzure context is set to the subscription that you want to use.
If you're using PowerShell locally, firstsign in with Azure PowerShell, and then make sure yourAzure context is set to the subscription that you want to use.
Use theNew-AzWvdHostPoolcmdlet with the following examples to create a host pool. More parameters are available. For more information, see theNew-AzWvdHostPool Azure PowerShell reference.To create a pooled host pool by using thebreadth-firstload-balancing algorithmanddesktopas the preferredapp group type, run the following command:$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Pooled'
     LoadBalancerType = 'BreadthFirst'
     PreferredAppGroupType = 'Desktop'
     MaxSessionLimit = '<value>'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parametersTo create a personal host pool by using theautomaticassignment type anddesktopas the preferredapp group type, run the following command:$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Personal'
     LoadBalancerType = 'Persistent'
     PreferredAppGroupType = 'Desktop'
     PersonalDesktopAssignmentType = 'Automatic'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
Use theNew-AzWvdHostPoolcmdlet with the following examples to create a host pool. More parameters are available. For more information, see theNew-AzWvdHostPool Azure PowerShell reference.
New-AzWvdHostPool
To create a pooled host pool by using thebreadth-firstload-balancing algorithmanddesktopas the preferredapp group type, run the following command:$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Pooled'
     LoadBalancerType = 'BreadthFirst'
     PreferredAppGroupType = 'Desktop'
     MaxSessionLimit = '<value>'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
To create a pooled host pool by using thebreadth-firstload-balancing algorithmanddesktopas the preferredapp group type, run the following command:
$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Pooled'
     LoadBalancerType = 'BreadthFirst'
     PreferredAppGroupType = 'Desktop'
     MaxSessionLimit = '<value>'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Pooled'
     LoadBalancerType = 'BreadthFirst'
     PreferredAppGroupType = 'Desktop'
     MaxSessionLimit = '<value>'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
To create a personal host pool by using theautomaticassignment type anddesktopas the preferredapp group type, run the following command:$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Personal'
     LoadBalancerType = 'Persistent'
     PreferredAppGroupType = 'Desktop'
     PersonalDesktopAssignmentType = 'Automatic'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
To create a personal host pool by using theautomaticassignment type anddesktopas the preferredapp group type, run the following command:
$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Personal'
     LoadBalancerType = 'Persistent'
     PreferredAppGroupType = 'Desktop'
     PersonalDesktopAssignmentType = 'Automatic'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
$parameters = @{
     Name = '<HostPoolName>'
     ResourceGroupName = '<ResourceGroupName>'
     HostPoolType = 'Personal'
     LoadBalancerType = 'Persistent'
     PreferredAppGroupType = 'Desktop'
     PersonalDesktopAssignmentType = 'Automatic'
     Location = '<AzureRegion>'
}

New-AzWvdHostPool @parameters
You can view the properties of your new host pool by running the following command:$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdHostPool @parameters | FL *
You can view the properties of your new host pool by running the following command:
$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdHostPool @parameters | FL *
$parameters = @{
    HostPoolName = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdHostPool @parameters | FL *
Here's how to create a host pool by using thedesktopvirtualizationextension for the Azure CLI. The following examples show you how to create a pooled host pool and a personal host pool. Be sure to change the<placeholder>values for your own.
<placeholder>
OpenAzure Cloud Shellin the Azure portal with theBashterminal type, or run the Azure CLI on your local device.If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.If you're using the Azure CLI locally, firstsign in with the Azure CLI, and then make sure yourAzure context is set to the subscription that you want to use.
OpenAzure Cloud Shellin the Azure portal with theBashterminal type, or run the Azure CLI on your local device.
If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.
If you're using Cloud Shell, make sure yourAzure context is set to the subscription that you want to use.
If you're using the Azure CLI locally, firstsign in with the Azure CLI, and then make sure yourAzure context is set to the subscription that you want to use.
If you're using the Azure CLI locally, firstsign in with the Azure CLI, and then make sure yourAzure context is set to the subscription that you want to use.
Use theaz desktopvirtualization hostpool createcommand with the following examples to create a host pool. More parameters are available. For more information, see theaz desktopvirtualization hostpool Azure CLI reference.To create a pooled host pool by using thebreadth-firstload-balancing algorithmanddesktopas the preferredapp group type, run the following command:az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Pooled \
     --load-balancer-type BreadthFirst \
     --preferred-app-group-type Desktop \
     --max-session-limit <value> \
     --location <AzureRegion>To create a personal host pool by using theautomaticassignment type, run the following command:az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Personal \
     --load-balancer-type Persistent \
     --preferred-app-group-type Desktop \
     --personal-desktop-assignment-type Automatic \
     --location <AzureRegion>
Use theaz desktopvirtualization hostpool createcommand with the following examples to create a host pool. More parameters are available. For more information, see theaz desktopvirtualization hostpool Azure CLI reference.
az desktopvirtualization hostpool create
To create a pooled host pool by using thebreadth-firstload-balancing algorithmanddesktopas the preferredapp group type, run the following command:az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Pooled \
     --load-balancer-type BreadthFirst \
     --preferred-app-group-type Desktop \
     --max-session-limit <value> \
     --location <AzureRegion>
To create a pooled host pool by using thebreadth-firstload-balancing algorithmanddesktopas the preferredapp group type, run the following command:
az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Pooled \
     --load-balancer-type BreadthFirst \
     --preferred-app-group-type Desktop \
     --max-session-limit <value> \
     --location <AzureRegion>
az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Pooled \
     --load-balancer-type BreadthFirst \
     --preferred-app-group-type Desktop \
     --max-session-limit <value> \
     --location <AzureRegion>
To create a personal host pool by using theautomaticassignment type, run the following command:az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Personal \
     --load-balancer-type Persistent \
     --preferred-app-group-type Desktop \
     --personal-desktop-assignment-type Automatic \
     --location <AzureRegion>
To create a personal host pool by using theautomaticassignment type, run the following command:
az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Personal \
     --load-balancer-type Persistent \
     --preferred-app-group-type Desktop \
     --personal-desktop-assignment-type Automatic \
     --location <AzureRegion>
az desktopvirtualization hostpool create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --host-pool-type Personal \
     --load-balancer-type Persistent \
     --preferred-app-group-type Desktop \
     --personal-desktop-assignment-type Automatic \
     --location <AzureRegion>
You can view the properties of your new host pool by running the following command:az desktopvirtualization hostpool show --name <Name> --resource-group <ResourceGroupName>
You can view the properties of your new host pool by running the following command:
az desktopvirtualization hostpool show --name <Name> --resource-group <ResourceGroupName>
az desktopvirtualization hostpool show --name <Name> --resource-group <ResourceGroupName>
Create a workspace
Next, to create a workspace, select the relevant tab for your scenario and follow the steps.
Azure portal
Azure PowerShell
Azure CLI
Here's how to create a workspace by using the Azure portal:
On the Azure Virtual Desktop overview, selectWorkspaces, and then selectCreate.
On the Azure Virtual Desktop overview, selectWorkspaces, and then selectCreate.
On theBasicstab, complete the following information:ParameterValue/DescriptionSubscriptionIn the dropdown list, select the subscription where you want to create the workspace.Resource groupSelect an existing resource group, or selectCreate newand enter a name.Workspace nameEnter a name for the workspace, such asworkspace01.Friendly nameOptional: Enter a display name for the workspace.DescriptionOptional: Enter a description for the workspace.LocationSelect the Azure region where you want to deploy your workspace.TipAfter you complete this tab, you can continue to optionally register an existing application group to this workspace, if you have one, and enable diagnostic settings by selectingNext: Application groups. Alternatively, if you want to create and configure these resources separately, selectReview + createand go to step 9.
On theBasicstab, complete the following information:
Tip
After you complete this tab, you can continue to optionally register an existing application group to this workspace, if you have one, and enable diagnostic settings by selectingNext: Application groups. Alternatively, if you want to create and configure these resources separately, selectReview + createand go to step 9.
Optional: On theApplication groupstab, if you want to register an existing application group to this workspace, complete the following information:ParameterValue/DescriptionRegister application groupsSelectYes, and then select+ Register application groups. On the new pane that opens, select theAddicon for the application groups that you want to add, and then chooseSelect.After you complete this tab, selectNext: Advanced.
Optional: On theApplication groupstab, if you want to register an existing application group to this workspace, complete the following information:
After you complete this tab, selectNext: Advanced.
Optional: On theAdvancedtab, if you want to enable diagnostic settings, complete the following information:ParameterValue/DescriptionEnable diagnostics settingsSelect the box.Choosing destination details to send logs toSelect one of the following destinations:- Send to a Log Analytics workspace- Archive to a storage account- Stream to an event hubAfter you complete this tab, selectNext: Tags.
Optional: On theAdvancedtab, if you want to enable diagnostic settings, complete the following information:
After you complete this tab, selectNext: Tags.
Optional: On theTagstab, you can enter any name/value pairs that you need, and then selectNext: Review + create.
Optional: On theTagstab, you can enter any name/value pairs that you need, and then selectNext: Review + create.
On theReview + createtab, ensure that validation passes and review the information that will be used during deployment.
On theReview + createtab, ensure that validation passes and review the information that will be used during deployment.
SelectCreateto create the workspace.
SelectCreateto create the workspace.
SelectGo to resourceto go to the overview of your new workspace, and then selectPropertiesto view its properties.
SelectGo to resourceto go to the overview of your new workspace, and then selectPropertiesto view its properties.
Note
If you added an application group to this workspace, go to the sectionAssign users to an application groupand complete the rest of the article.
If you added an application group to this workspace, go to the sectionAssign users to an application groupand complete the rest of the article.
If you didn't add an application group to this workspace, continue to the next section and complete the rest of the article.
If you didn't add an application group to this workspace, continue to the next section and complete the rest of the article.
Here's how to create a workspace by using theAz.DesktopVirtualizationAzure PowerShell module:
In the same PowerShell session, use theNew-AzWvdWorkspacecmdlet with the following example to create a workspace. More parameters are available, such as parameters to register existing application groups. For more information, see theNew-AzWvdWorkspace Azure PowerShell reference.$parameters = @{
   Name = '<WorkspaceName>'
   ResourceGroupName = '<ResourceGroupName>'
   Location = '<AzureRegion>'
}

New-AzWvdWorkspace @parameters
In the same PowerShell session, use theNew-AzWvdWorkspacecmdlet with the following example to create a workspace. More parameters are available, such as parameters to register existing application groups. For more information, see theNew-AzWvdWorkspace Azure PowerShell reference.
New-AzWvdWorkspace
$parameters = @{
   Name = '<WorkspaceName>'
   ResourceGroupName = '<ResourceGroupName>'
   Location = '<AzureRegion>'
}

New-AzWvdWorkspace @parameters
$parameters = @{
   Name = '<WorkspaceName>'
   ResourceGroupName = '<ResourceGroupName>'
   Location = '<AzureRegion>'
}

New-AzWvdWorkspace @parameters
You can view the properties of your new workspace by running the following command:$parameters = @{
   Name = '<WorkspaceName>'
   ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdWorkspace @parameters | FL *
You can view the properties of your new workspace by running the following command:
$parameters = @{
   Name = '<WorkspaceName>'
   ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdWorkspace @parameters | FL *
$parameters = @{
   Name = '<WorkspaceName>'
   ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdWorkspace @parameters | FL *
Here's how to create a workspace by using thedesktopvirtualizationextension for the Azure CLI:
In the same CLI session, use theaz desktopvirtualization workspace createcommand with the following example to create a workspace. More parameters are available, such as parameters to register existing application groups. For more information, see theaz desktopvirtualization workspace Azure CLI reference.az desktopvirtualization workspace create \
    --name <Name> \
    --resource-group <ResourceGroupName>
In the same CLI session, use theaz desktopvirtualization workspace createcommand with the following example to create a workspace. More parameters are available, such as parameters to register existing application groups. For more information, see theaz desktopvirtualization workspace Azure CLI reference.
az desktopvirtualization workspace create
az desktopvirtualization workspace create \
    --name <Name> \
    --resource-group <ResourceGroupName>
az desktopvirtualization workspace create \
    --name <Name> \
    --resource-group <ResourceGroupName>
You can view the properties of your new workspace by running the following command:az desktopvirtualization workspace show \
    --name <Name> \
    --resource-group <ResourceGroupName>
You can view the properties of your new workspace by running the following command:
az desktopvirtualization workspace show \
    --name <Name> \
    --resource-group <ResourceGroupName>
az desktopvirtualization workspace show \
    --name <Name> \
    --resource-group <ResourceGroupName>
Create an application group
To create an application group, select the relevant tab for your scenario and follow the steps.
Azure portal
Azure PowerShell
Azure CLI
Here's how to create an application group by using the Azure portal:
On the Azure Virtual Desktop overview, selectApplication groups, and then selectCreate.
On the Azure Virtual Desktop overview, selectApplication groups, and then selectCreate.
On theBasicstab, complete the following information:ParameterValue/DescriptionSubscriptionIn the dropdown list, select the subscription where you want to create the application group.Resource groupSelect an existing resource group, or selectCreate newand enter a name.Host poolSelect the host pool for the application group.LocationMetadata is stored in the same location as the host pool.Application group typeSelect theapplication group typefor the host pool:DesktoporRemoteApp.Application group nameEnter a name for the application group, such asSession Desktop.TipAfter you complete this tab, selectNext: Review + create. You don't need to complete the other tabs to create an application group, but you need tocreate a workspace,add an application group to a workspace, andassign users to the application groupbefore users can access the resources.If you created an application group for RemoteApp, you also need to add applications to it. For more information, seePublish applications.
On theBasicstab, complete the following information:
Tip
After you complete this tab, selectNext: Review + create. You don't need to complete the other tabs to create an application group, but you need tocreate a workspace,add an application group to a workspace, andassign users to the application groupbefore users can access the resources.
If you created an application group for RemoteApp, you also need to add applications to it. For more information, seePublish applications.
Optional: If you chose to create a RemoteApp application group, you can add applications to this group. On theApplication groupstab, select+ Add applications, and then select an application. For more information on the application parameters, seePublish applications with RemoteApp. At least one session host in the host pool must be turned on and available in Azure Virtual Desktop.After you complete this tab, or if you're creating a desktop application group, selectNext: Assignments.
Optional: If you chose to create a RemoteApp application group, you can add applications to this group. On theApplication groupstab, select+ Add applications, and then select an application. For more information on the application parameters, seePublish applications with RemoteApp. At least one session host in the host pool must be turned on and available in Azure Virtual Desktop.
After you complete this tab, or if you're creating a desktop application group, selectNext: Assignments.
Optional: On theAssignmentstab, if you want to assign users or groups to this application group, select+ Add Microsoft Entra users or user groups. On the new pane that opens, select the box next to the users or groups that you want to add, and then chooseSelect.After you complete this tab, selectNext: Workspace.
Optional: On theAssignmentstab, if you want to assign users or groups to this application group, select+ Add Microsoft Entra users or user groups. On the new pane that opens, select the box next to the users or groups that you want to add, and then chooseSelect.
After you complete this tab, selectNext: Workspace.
Optional: On theWorkspacetab, if you're creating a desktop application group, you can register the default desktop application group from the host pool that you selected by completing the following information:ParameterValue/DescriptionRegister application groupSelectYes. This action registers the default desktop application group to the selected workspace.Register application groupSelect an existing workspace from the list.After you complete this tab, selectNext: Advanced.
Optional: On theWorkspacetab, if you're creating a desktop application group, you can register the default desktop application group from the host pool that you selected by completing the following information:
After you complete this tab, selectNext: Advanced.
Optional: If you want to enable diagnostic settings, on theAdvancedtab, complete the following information:ParameterValue/DescriptionEnable diagnostics settingsSelect the box.Choosing destination details to send logs toSelect one of the following destinations:- Send to a Log Analytics workspace- Archive to a storage account- Stream to an event hubAfter you complete this tab, selectNext: Tags.
Optional: If you want to enable diagnostic settings, on theAdvancedtab, complete the following information:
After you complete this tab, selectNext: Tags.
Optional: On theTagstab, you can enter any name/value pairs that you need, and then selectNext: Review + create.
Optional: On theTagstab, you can enter any name/value pairs that you need, and then selectNext: Review + create.
On theReview + createtab, ensure that validation passes and review the information that will be used during deployment.
On theReview + createtab, ensure that validation passes and review the information that will be used during deployment.
SelectCreateto create the application group.
SelectCreateto create the application group.
SelectGo to resourceto go to the overview of your new application group, and then selectPropertiesto view its properties.
SelectGo to resourceto go to the overview of your new application group, and then selectPropertiesto view its properties.
Note
If you created a desktop application group, assigned users or groups, and registered the default desktop application group to a workspace, your assigned users can connect to the desktop and you don't need to complete the rest of the article.
If you created a desktop application group, assigned users or groups, and registered the default desktop application group to a workspace, your assigned users can connect to the desktop and you don't need to complete the rest of the article.
If you created a RemoteApp application group, added applications, and assigned users or groups, go to the sectionAdd an application group to a workspaceand complete the rest of the article.
If you created a RemoteApp application group, added applications, and assigned users or groups, go to the sectionAdd an application group to a workspaceand complete the rest of the article.
If you didn't add applications, assign users or groups, or register the application group to a workspace, continue to the next section and complete the rest of the article.
If you didn't add applications, assign users or groups, or register the application group to a workspace, continue to the next section and complete the rest of the article.
Here's how to create an application group by using theAz.DesktopVirtualizationAzure PowerShell module:
In the same PowerShell session, get the resource ID of the host pool for which you want to create an application group and store it in a variable by running the following command:$parameters = @{
    Name = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

$hostPoolArmPath = (Get-AzWvdHostPool @parameters).Id
In the same PowerShell session, get the resource ID of the host pool for which you want to create an application group and store it in a variable by running the following command:
$parameters = @{
    Name = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

$hostPoolArmPath = (Get-AzWvdHostPool @parameters).Id
$parameters = @{
    Name = '<HostPoolName>'
    ResourceGroupName = '<ResourceGroupName>'
}

$hostPoolArmPath = (Get-AzWvdHostPool @parameters).Id
Use theNew-AzWvdApplicationGroupcmdlet with the following examples to create an application group. For more information, see theNew-AzWvdApplicationGroup Azure PowerShell reference.To create a desktop application group, run the following command:$parameters = @{
     Name = '<ApplicationGroupName>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'Desktop'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parametersTo create a RemoteApp application group, run the following command. You can only create a RemoteApp application group with a pooled host pool.$parameters = @{
     Name = '<Name>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'RemoteApp'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
Use theNew-AzWvdApplicationGroupcmdlet with the following examples to create an application group. For more information, see theNew-AzWvdApplicationGroup Azure PowerShell reference.
New-AzWvdApplicationGroup
To create a desktop application group, run the following command:$parameters = @{
     Name = '<ApplicationGroupName>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'Desktop'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
To create a desktop application group, run the following command:
$parameters = @{
     Name = '<ApplicationGroupName>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'Desktop'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
$parameters = @{
     Name = '<ApplicationGroupName>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'Desktop'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
To create a RemoteApp application group, run the following command. You can only create a RemoteApp application group with a pooled host pool.$parameters = @{
     Name = '<Name>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'RemoteApp'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
To create a RemoteApp application group, run the following command. You can only create a RemoteApp application group with a pooled host pool.
$parameters = @{
     Name = '<Name>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'RemoteApp'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
$parameters = @{
     Name = '<Name>'
     ResourceGroupName = '<ResourceGroupName>'
     ApplicationGroupType = 'RemoteApp'
     HostPoolArmPath = $hostPoolArmPath
     Location = '<AzureRegion>'
}

New-AzWvdApplicationGroup @parameters
You can view the properties of your new application group by running the following command:$parameters = @{
   Name = '<ApplicationGroupName>'
   ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdApplicationGroup @parameters | FL *
You can view the properties of your new application group by running the following command:
$parameters = @{
   Name = '<ApplicationGroupName>'
   ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdApplicationGroup @parameters | FL *
$parameters = @{
   Name = '<ApplicationGroupName>'
   ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdApplicationGroup @parameters | FL *
Here's how to create an application group by using thedesktopvirtualizationextension for the Azure CLI:
In the same CLI session, get the resource ID of the host pool for which you want to create an application group and store it in a variable by running the following command:hostPoolArmPath=$(az desktopvirtualization hostpool show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)
In the same CLI session, get the resource ID of the host pool for which you want to create an application group and store it in a variable by running the following command:
hostPoolArmPath=$(az desktopvirtualization hostpool show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)
hostPoolArmPath=$(az desktopvirtualization hostpool show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)
Use theaz desktopvirtualization applicationgroup createcommand with the following examples to create an application group. For more information, see theaz desktopvirtualization applicationgroup Azure CLI reference.To create a Desktop application group, run the following command:az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type Desktop \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>To create a RemoteApp application group, run the following command. You can only create a RemoteApp application group with a pooled host pool.az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type RemoteApp \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
Use theaz desktopvirtualization applicationgroup createcommand with the following examples to create an application group. For more information, see theaz desktopvirtualization applicationgroup Azure CLI reference.
az desktopvirtualization applicationgroup create
To create a Desktop application group, run the following command:az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type Desktop \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
To create a Desktop application group, run the following command:
az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type Desktop \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type Desktop \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
To create a RemoteApp application group, run the following command. You can only create a RemoteApp application group with a pooled host pool.az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type RemoteApp \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
To create a RemoteApp application group, run the following command. You can only create a RemoteApp application group with a pooled host pool.
az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type RemoteApp \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
az desktopvirtualization applicationgroup create \
     --name <Name> \
     --resource-group <ResourceGroupName> \
     --application-group-type RemoteApp \
     --host-pool-arm-path $hostPoolArmPath \
     --location <AzureRegion>
You can view the properties of your new application group by running the following command:az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName>
You can view the properties of your new application group by running the following command:
az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName>
az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName>
Add an application group to a workspace
Next, to add an application group to a workspace, select the relevant tab for your scenario and follow the steps.
Azure portal
Azure PowerShell
Azure CLI
Here's how to add an application group to a workspace by using the Azure portal:
On the Azure Virtual Desktop overview, selectWorkspaces, and then select the name of the workspace to which you want to assign an application group.
On the Azure Virtual Desktop overview, selectWorkspaces, and then select the name of the workspace to which you want to assign an application group.
On the workspace overview, selectApplication groups, and then select+ Add.
On the workspace overview, selectApplication groups, and then select+ Add.
In the list, select the plus icon (+) next to an application group. Only application groups that aren't already assigned to a workspace are listed.
In the list, select the plus icon (+) next to an application group. Only application groups that aren't already assigned to a workspace are listed.
ChooseSelect. The application group is added to the workspace.
ChooseSelect. The application group is added to the workspace.
Here's how to add an application group to a workspace by using theAz.DesktopVirtualizationAzure PowerShell module:
In the same PowerShell session, use theUpdate-AzWvdWorkspacecmdlet with the following example to add an application group to a workspace:# Get the resource ID of the application group that you want to add to the workspace

$parameters = @{
    Name = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
}

$appGroupPath = (Get-AzWvdApplicationGroup @parameters).Id

# Add the application group to the workspace
$parameters = @{
    Name = '<WorkspaceName>'
    ResourceGroupName = '<ResourceGroupName>'
    ApplicationGroupReference = $appGroupPath
}

Update-AzWvdWorkspace @parameters
In the same PowerShell session, use theUpdate-AzWvdWorkspacecmdlet with the following example to add an application group to a workspace:
Update-AzWvdWorkspace
# Get the resource ID of the application group that you want to add to the workspace

$parameters = @{
    Name = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
}

$appGroupPath = (Get-AzWvdApplicationGroup @parameters).Id

# Add the application group to the workspace
$parameters = @{
    Name = '<WorkspaceName>'
    ResourceGroupName = '<ResourceGroupName>'
    ApplicationGroupReference = $appGroupPath
}

Update-AzWvdWorkspace @parameters
# Get the resource ID of the application group that you want to add to the workspace

$parameters = @{
    Name = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
}

$appGroupPath = (Get-AzWvdApplicationGroup @parameters).Id

# Add the application group to the workspace
$parameters = @{
    Name = '<WorkspaceName>'
    ResourceGroupName = '<ResourceGroupName>'
    ApplicationGroupReference = $appGroupPath
}

Update-AzWvdWorkspace @parameters
You can view the properties of your workspace by running the following command. The keyApplicationGroupReferencecontains an array of the application groups added to the workspace.$parameters = @{
    Name = '<WorkspaceName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdWorkspace @parameters | FL *
You can view the properties of your workspace by running the following command. The keyApplicationGroupReferencecontains an array of the application groups added to the workspace.
ApplicationGroupReference
$parameters = @{
    Name = '<WorkspaceName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdWorkspace @parameters | FL *
$parameters = @{
    Name = '<WorkspaceName>'
    ResourceGroupName = '<ResourceGroupName>'
}

Get-AzWvdWorkspace @parameters | FL *
Here's how to add an application group to a workspace by using thedesktopvirtualizationextension for the Azure CLI:
In the same CLI session, use theaz desktopvirtualization workspace updatecommand with the following example to add an application group to a workspace:# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Add the application group to the workspace
az desktopvirtualization workspace update \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --application-group-references $appGroupPath
In the same CLI session, use theaz desktopvirtualization workspace updatecommand with the following example to add an application group to a workspace:
az desktopvirtualization workspace update
# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Add the application group to the workspace
az desktopvirtualization workspace update \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --application-group-references $appGroupPath
# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Add the application group to the workspace
az desktopvirtualization workspace update \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --application-group-references $appGroupPath
You can view the properties of your workspace by running the following command. The keyapplicationGroupReferencescontains an array of the application groups added to the workspace.az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName>
You can view the properties of your workspace by running the following command. The keyapplicationGroupReferencescontains an array of the application groups added to the workspace.
applicationGroupReferences
az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName>
az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName>
Assign users to an application group
Finally, to assign users or user groups to an application group, select the relevant tab for your scenario and follow the steps. We recommend that you assign user groups to application groups to make ongoing management simpler.
The account you use needs permission to assign roles in Azure RBAC on the application group after it's created. The permission isMicrosoft.Authorization/roleAssignments/write, which is included in some built-in roles, such asUser Access AdministratorandOwner.
Microsoft.Authorization/roleAssignments/write
Azure portal
Azure PowerShell
Azure CLI
Here's how to assign users or user groups to an application group by using the Azure portal:
On the Azure Virtual Desktop overview, selectApplication groups.
On the Azure Virtual Desktop overview, selectApplication groups.
Select the application group from the list.
Select the application group from the list.
On the application group overview, selectAssignments.
On the application group overview, selectAssignments.
Select+ Add, and then search for and select the user account or user group that you want to assign to this application group.
Select+ Add, and then search for and select the user account or user group that you want to assign to this application group.
Finish by choosingSelect.
Finish by choosingSelect.
Here's how to assign users or user groups to an application group by using theAz.ResourcesAzure PowerShell module.
In the same PowerShell session, use theNew-AzRoleAssignmentcmdlet with the following examples to assign users or user groups to an application group:
New-AzRoleAssignment
To assign users to the application group, run the following commands:$parameters = @{
    SignInName = '<UserPrincipalName>'
    ResourceName = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
    RoleDefinitionName = 'Desktop Virtualization User'
    ResourceType = 'Microsoft.DesktopVirtualization/applicationGroups'
}

New-AzRoleAssignment @parameters
To assign users to the application group, run the following commands:
$parameters = @{
    SignInName = '<UserPrincipalName>'
    ResourceName = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
    RoleDefinitionName = 'Desktop Virtualization User'
    ResourceType = 'Microsoft.DesktopVirtualization/applicationGroups'
}

New-AzRoleAssignment @parameters
$parameters = @{
    SignInName = '<UserPrincipalName>'
    ResourceName = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
    RoleDefinitionName = 'Desktop Virtualization User'
    ResourceType = 'Microsoft.DesktopVirtualization/applicationGroups'
}

New-AzRoleAssignment @parameters
To assign user groups to the application group, run the following commands:# Get the object ID of the user group that you want to assign to the application group
$userGroupId = (Get-AzADGroup -DisplayName "<UserGroupName>").Id

# Assign users to the application group
$parameters = @{
    ObjectId = $userGroupId
    ResourceName = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
    RoleDefinitionName = 'Desktop Virtualization User'
    ResourceType = 'Microsoft.DesktopVirtualization/applicationGroups'
}

New-AzRoleAssignment @parameters
To assign user groups to the application group, run the following commands:
# Get the object ID of the user group that you want to assign to the application group
$userGroupId = (Get-AzADGroup -DisplayName "<UserGroupName>").Id

# Assign users to the application group
$parameters = @{
    ObjectId = $userGroupId
    ResourceName = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
    RoleDefinitionName = 'Desktop Virtualization User'
    ResourceType = 'Microsoft.DesktopVirtualization/applicationGroups'
}

New-AzRoleAssignment @parameters
# Get the object ID of the user group that you want to assign to the application group
$userGroupId = (Get-AzADGroup -DisplayName "<UserGroupName>").Id

# Assign users to the application group
$parameters = @{
    ObjectId = $userGroupId
    ResourceName = '<ApplicationGroupName>'
    ResourceGroupName = '<ResourceGroupName>'
    RoleDefinitionName = 'Desktop Virtualization User'
    ResourceType = 'Microsoft.DesktopVirtualization/applicationGroups'
}

New-AzRoleAssignment @parameters
Here's how to assign users or user groups to an application group by using theroleextension for the Azure CLI.
In the same CLI session, use theaz role assignment createcommand with the following examples to assign users or user groups to an application group:
az role assignment create
To assign users to the application group, run the following commands:# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Assign users to the application group
az role assignment create \
    --assignee '<UserPrincipalName>' \
    --role 'Desktop Virtualization User' \
    --scope $appGroupPath
To assign users to the application group, run the following commands:
# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Assign users to the application group
az role assignment create \
    --assignee '<UserPrincipalName>' \
    --role 'Desktop Virtualization User' \
    --scope $appGroupPath
# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Assign users to the application group
az role assignment create \
    --assignee '<UserPrincipalName>' \
    --role 'Desktop Virtualization User' \
    --scope $appGroupPath
To assign user groups to the application group, run the following commands:# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Get the object ID of the user group that you want to assign to the application group
userGroupId=$(az ad group show \
    --group <UserGroupName> \
    --query [id] \
    --output tsv)

# Assign users to the application group
az role assignment create \
    --assignee $userGroupId \
    --role 'Desktop Virtualization User' \
    --scope $appGroupPath
To assign user groups to the application group, run the following commands:
# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Get the object ID of the user group that you want to assign to the application group
userGroupId=$(az ad group show \
    --group <UserGroupName> \
    --query [id] \
    --output tsv)

# Assign users to the application group
az role assignment create \
    --assignee $userGroupId \
    --role 'Desktop Virtualization User' \
    --scope $appGroupPath
# Get the resource ID of the application group that you want to add to the workspace
appGroupPath=$(az desktopvirtualization applicationgroup show \
    --name <Name> \
    --resource-group <ResourceGroupName> \
    --query [id] \
    --output tsv)

# Get the object ID of the user group that you want to assign to the application group
userGroupId=$(az ad group show \
    --group <UserGroupName> \
    --query [id] \
    --output tsv)

# Assign users to the application group
az role assignment create \
    --assignee $userGroupId \
    --role 'Desktop Virtualization User' \
    --scope $appGroupPath
Related content
Azure portal
Azure PowerShell
Azure CLI
After you deploy Azure Virtual Desktop, your users can connect from several platforms, including a web browser. For more information, seeRemote Desktop clients for Azure Virtual DesktopandConnect to Azure Virtual Desktop with the Remote Desktop Web client.
Here are some extra tasks that you might want to do:
Configure profile management for Azure Virtual Desktop by using FSLogix profile containers
Add session hosts to a host pool
Enable diagnostic settings
After you deploy a host pool, workspace, and application group, you need to create session hosts before your users can connect. Follow the steps inAdd session hosts to a host pool.
Here are some extra tasks that you might want to do:
Configure profile management for Azure Virtual Desktop by using FSLogix profile containers
Enable diagnostic settings
After you deploy a host pool, workspace, and application group, you need to create session hosts before your users can connect. Follow the steps inAdd session hosts to a host pool.
Here are some extra tasks that you might want to do:
Configure profile management for Azure Virtual Desktop by using FSLogix profile containers
Enable diagnostic settings
Feedback
Was this page helpful?
Additional resources