Note
Access to this page requires authorization. You can trysigning inorchanging directories.
Access to this page requires authorization. You can trychanging directories.
Create, change, or delete a network interface
Article
2024-10-09
29 contributors
In this article
A network interface (NIC) enables an Azure virtual machine (VM) to communicate with internet, Azure, and on-premises resources. This article explains how to create, view and change settings for, and delete a NIC.
A VM you create in the Azure portal has one NIC with default settings. You can create NICs with custom settings instead, and add one or more NICs to a VM when or after you create it. You can also change settings for an existing NIC.
Prerequisites
Portal
Azure CLI
PowerShell
You need the following prerequisites:
An Azure account with an active subscription.Create an account for free.
An existing Azure virtual network. To create one, seeQuickstart: Create a virtual network by using the Azure portal.
To run the procedures in this article, sign in to theAzure portalwith your Azure account. You can replace the placeholders in the examples with your own values.
To run the commands in this article, you need the following prerequisites:
An Azure account with an active subscription.Create an account for free.
An existing Azure virtual network. To create one, seeQuickstart: Create a virtual network by using Azure CLI.
You can run the commands either in theAzure Cloud Shellor from Azure CLI on your computer.
Azure Cloud Shell is a free interactive shell that has common Azure tools preinstalled and configured to use with your account. To run the commands in the Cloud Shell, selectOpen Cloudshellat the upper-right corner of a code block. SelectCopyto copy the code, and paste it into Cloud Shell to run it. You can also run the Cloud Shell from within the Azure portal.
Azure Cloud Shell is a free interactive shell that has common Azure tools preinstalled and configured to use with your account. To run the commands in the Cloud Shell, selectOpen Cloudshellat the upper-right corner of a code block. SelectCopyto copy the code, and paste it into Cloud Shell to run it. You can also run the Cloud Shell from within the Azure portal.
If youinstall Azure CLI locallyto run the commands, you need Azure CLI version 2.31.0 or later. Runaz versionto find your installed version, and runaz upgradeto upgrade.If you're prompted, install the Azure CLI extension on first use. For more information,Use extensions with the Azure CLI.Runaz loginto connect to Azure. For more information, seeSign in with Azure CLI.
If youinstall Azure CLI locallyto run the commands, you need Azure CLI version 2.31.0 or later. Runaz versionto find your installed version, and runaz upgradeto upgrade.
If you're prompted, install the Azure CLI extension on first use. For more information,Use extensions with the Azure CLI.
Runaz loginto connect to Azure. For more information, seeSign in with Azure CLI.
In the following procedures, you can replace the example placeholder names with your own values.
To run the commands in this article, you need the following prerequisites:
An Azure account with an active subscription.Create an account for free.
An existing Azure virtual network. To create one, seeQuickstart: Create a virtual network by using Azure PowerShell.
You can run the commands either in theAzure Cloud Shellor from PowerShell on your computer.
Azure Cloud Shell is a free interactive shell that has common Azure tools preinstalled and configured to use with your account. To run the commands in the Cloud Shell, selectOpen Cloudshellat the upper-right corner of a code block. SelectCopyto copy the code, and paste it into Cloud Shell to run it. You can also run the Cloud Shell from within the Azure portal.
Azure Cloud Shell is a free interactive shell that has common Azure tools preinstalled and configured to use with your account. To run the commands in the Cloud Shell, selectOpen Cloudshellat the upper-right corner of a code block. SelectCopyto copy the code, and paste it into Cloud Shell to run it. You can also run the Cloud Shell from within the Azure portal.
If youinstall Azure PowerShell locallyto run the commands, you need Azure PowerShell module version 5.4.1 or later. RunGet-Module -ListAvailable Azto find your installed version. If you need to upgrade, seeUpdate the Azure PowerShell module.Also make sure yourAz.Networkmodule is 4.3.0 or later. To verify the installed module, useGet-InstalledModule -Name "Az.Network". To update, use the commandUpdate-Module -Name Az.Network.Then runConnect-AzAccountto connect to Azure. For more information, seeSign in with Azure PowerShell.
If youinstall Azure PowerShell locallyto run the commands, you need Azure PowerShell module version 5.4.1 or later. RunGet-Module -ListAvailable Azto find your installed version. If you need to upgrade, seeUpdate the Azure PowerShell module.
Get-Module -ListAvailable Az
Also make sure yourAz.Networkmodule is 4.3.0 or later. To verify the installed module, useGet-InstalledModule -Name "Az.Network". To update, use the commandUpdate-Module -Name Az.Network.
Az.Network
Get-InstalledModule -Name "Az.Network"
Update-Module -Name Az.Network
Then runConnect-AzAccountto connect to Azure. For more information, seeSign in with Azure PowerShell.
Connect-AzAccount
In the following procedures, you can replace the example placeholder names with your own values.
Permissions
To work with NICs, your account must be assigned to thenetwork contributorrole or to acustom rolethat's assigned the appropriate actions from the following list:
Create a network interface
You can create a NIC in the Azure portal or by using Azure CLI or Azure PowerShell.
The portal doesn't provide the option to assign a public IP address to a NIC when you create it. If you want to create a NIC with a public IP address, use Azure CLI or PowerShell. To add a public IP address to a NIC after you create it, seeConfigure IP addresses for an Azure network interface.
The portal doesn't provide the option to assign a public IP address to a NIC when you create it. If you want to create a NIC with a public IP address, use Azure CLI or PowerShell. To add a public IP address to a NIC after you create it, seeConfigure IP addresses for an Azure network interface.
The portal does create a NIC with default settings and a public IP address when you create a VM. To create a NIC with custom settings and attach it to a VM, or to add a NIC to an existing VM, use PowerShell or Azure CLI.
The portal does create a NIC with default settings and a public IP address when you create a VM. To create a NIC with custom settings and attach it to a VM, or to add a NIC to an existing VM, use PowerShell or Azure CLI.
The portal doesn't provide the option to assign a NIC to application security groups when you create the NIC, but Azure CLI and PowerShell do. However, if an existing NIC is attached to a VM, you can use the portal to assign that NIC to an application security group. For more information, seeAdd to or remove from application security groups.
The portal doesn't provide the option to assign a NIC to application security groups when you create the NIC, but Azure CLI and PowerShell do. However, if an existing NIC is attached to a VM, you can use the portal to assign that NIC to an application security group. For more information, seeAdd to or remove from application security groups.
To create a NIC, use the following procedure.
Portal
Azure CLI
PowerShell
In theAzure portal, search for and selectnetwork interfaces.
In theAzure portal, search for and selectnetwork interfaces.
On theNetwork interfacespage, selectCreate.
On theNetwork interfacespage, selectCreate.
On theCreate network interfacescreen, enter or select values for the NIC settings.
On theCreate network interfacescreen, enter or select values for the NIC settings.
SelectReview + create, and when validation passes, selectCreate.
SelectReview + create, and when validation passes, selectCreate.
The following example creates an Azure public IP address and associates it with the NIC.
Useaz network public-ip createto create a primary public IP address.az network public-ip create \
    --resource-group myResourceGroup \
    --name myPublicIP \
    --sku Standard \
    --version IPv4 \
    --zone 1 2 3
Useaz network public-ip createto create a primary public IP address.
az network public-ip create \
    --resource-group myResourceGroup \
    --name myPublicIP \
    --sku Standard \
    --version IPv4 \
    --zone 1 2 3
az network public-ip create \
    --resource-group myResourceGroup \
    --name myPublicIP \
    --sku Standard \
    --version IPv4 \
    --zone 1 2 3
Useaz network nic createto create the NIC. To create a NIC without a public IP address, omit the--public-ip-addressparameter foraz network nic create.
Useaz network nic createto create the NIC. To create a NIC without a public IP address, omit the--public-ip-addressparameter foraz network nic create.
--public-ip-address
az network nic create
az network nic create \
    --resource-group myResourceGroup \
    --name myNIC \
    --private-ip-address-version IPv4 \
    --vnet-name myVNet \
    --subnet myBackEndSubnet \
    --public-ip-address myPublicIP
az network nic create \
    --resource-group myResourceGroup \
    --name myNIC \
    --private-ip-address-version IPv4 \
    --vnet-name myVNet \
    --subnet myBackEndSubnet \
    --public-ip-address myPublicIP
The following example creates an Azure public IP address and associates it with the NIC.
UseNew-AzPublicIpAddressto create a primary public IP address.$ip = @{
    Name = 'myPublicIP'
    ResourceGroupName = 'myResourceGroup'
    Location = 'eastus2'
    Sku = 'Standard'
    AllocationMethod = 'Static'
    IpAddressVersion = 'IPv4'
    Zone = 1,2,3
}
New-AzPublicIpAddress @ip
UseNew-AzPublicIpAddressto create a primary public IP address.
$ip = @{
    Name = 'myPublicIP'
    ResourceGroupName = 'myResourceGroup'
    Location = 'eastus2'
    Sku = 'Standard'
    AllocationMethod = 'Static'
    IpAddressVersion = 'IPv4'
    Zone = 1,2,3
}
New-AzPublicIpAddress @ip
$ip = @{
    Name = 'myPublicIP'
    ResourceGroupName = 'myResourceGroup'
    Location = 'eastus2'
    Sku = 'Standard'
    AllocationMethod = 'Static'
    IpAddressVersion = 'IPv4'
    Zone = 1,2,3
}
New-AzPublicIpAddress @ip
UseNew-AzNetworkInterfaceIpConfigandNew-AzNetworkInterfaceto create the NIC. To create a NIC without a public IP address, omit the-PublicIpAddressparameter forNew-AzNetworkInterfaceIPConfig.## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the primary public IP address into a variable. ##
$pub = @{
    Name = 'myPublicIP'
    ResourceGroupName = 'myResourceGroup'
}
$pubIP = Get-AzPublicIPAddress @pub

## Create primary configuration for NIC. ##
$IP1 = @{
    Name = 'ipconfig1'
    Subnet = $vnet.Subnets[0]
    PrivateIpAddressVersion = 'IPv4'
    PublicIPAddress = $pubIP
}
$IP1Config = New-AzNetworkInterfaceIpConfig @IP1 -Primary

## Command to create network interface for VM ##
$nic = @{
    Name = 'myNIC'
    ResourceGroupName = 'myResourceGroup'
    Location = 'eastus2'
    IpConfiguration = $IP1Config
}
New-AzNetworkInterface @nic
UseNew-AzNetworkInterfaceIpConfigandNew-AzNetworkInterfaceto create the NIC. To create a NIC without a public IP address, omit the-PublicIpAddressparameter forNew-AzNetworkInterfaceIPConfig.
-PublicIpAddress
New-AzNetworkInterfaceIPConfig
## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the primary public IP address into a variable. ##
$pub = @{
    Name = 'myPublicIP'
    ResourceGroupName = 'myResourceGroup'
}
$pubIP = Get-AzPublicIPAddress @pub

## Create primary configuration for NIC. ##
$IP1 = @{
    Name = 'ipconfig1'
    Subnet = $vnet.Subnets[0]
    PrivateIpAddressVersion = 'IPv4'
    PublicIPAddress = $pubIP
}
$IP1Config = New-AzNetworkInterfaceIpConfig @IP1 -Primary

## Command to create network interface for VM ##
$nic = @{
    Name = 'myNIC'
    ResourceGroupName = 'myResourceGroup'
    Location = 'eastus2'
    IpConfiguration = $IP1Config
}
New-AzNetworkInterface @nic
## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the primary public IP address into a variable. ##
$pub = @{
    Name = 'myPublicIP'
    ResourceGroupName = 'myResourceGroup'
}
$pubIP = Get-AzPublicIPAddress @pub

## Create primary configuration for NIC. ##
$IP1 = @{
    Name = 'ipconfig1'
    Subnet = $vnet.Subnets[0]
    PrivateIpAddressVersion = 'IPv4'
    PublicIPAddress = $pubIP
}
$IP1Config = New-AzNetworkInterfaceIpConfig @IP1 -Primary

## Command to create network interface for VM ##
$nic = @{
    Name = 'myNIC'
    ResourceGroupName = 'myResourceGroup'
    Location = 'eastus2'
    IpConfiguration = $IP1Config
}
New-AzNetworkInterface @nic
You can configure the following settings for a NIC:
Note
Azure assigns a MAC address to the NIC only after the NIC is attached to a VM and the VM starts for the first time. You can't specify the MAC address that Azure assigns to the NIC.
The MAC address remains assigned to the NIC until the NIC is deleted or the private IP address assigned to the primary IP configuration of the primary NIC changes. For more information, seeConfigure IP addresses for an Azure network interface.
Note
Azure provides a default outbound access IP for VMs that either aren't assigned a public IP address or are in the backend pool of an internal basic Azure load balancer. The default outbound access IP mechanism provides an outbound IP address that isn't configurable.
The default outbound access IP is disabled when one of the following events happens:
A public IP address is assigned to the VM.
The VM is placed in the backend pool of a standard load balancer, with or without outbound rules.
AnAzure NAT Gatewayresource is assigned to the subnet of the VM.
VMs that you create by using virtual machine scale sets in flexible orchestration mode don't have default outbound access.
For more information about outbound connections in Azure, seeDefault outbound access in AzureandUse Source Network Address Translation (SNAT) for outbound connections.
View network interface settings
You can view most settings for a NIC after you create it. The portal doesn't display the DNS suffix or application security group membership for the NIC. You can use Azure PowerShell or Azure CLI to view the DNS suffix and application security group membership.
Portal
Azure CLI
PowerShell
In theAzure portal, search for and selectNetwork interfaces.
In theAzure portal, search for and selectNetwork interfaces.
On theNetwork interfacespage, select the NIC you want to view.
On theNetwork interfacespage, select the NIC you want to view.
On theOverviewpage for the NIC, view essential information such as IPv4 and IPv6 IP addresses and network security group (NSG) membership.You can selectEdit accelerated networkingto set accelerated networking for NICs. For more information about accelerated networking, seeWhat is Accelerated Networking?
On theOverviewpage for the NIC, view essential information such as IPv4 and IPv6 IP addresses and network security group (NSG) membership.
You can selectEdit accelerated networkingto set accelerated networking for NICs. For more information about accelerated networking, seeWhat is Accelerated Networking?

SelectIP configurationsin the left navigation, and on theIP configurationspage, view theIP forwarding,Subnet, and public and private IPv4 and IPv6 IP configurations. For more information about IP configurations and how to add and remove IP addresses, seeConfigure IP addresses for an Azure network interface.
SelectIP configurationsin the left navigation, and on theIP configurationspage, view theIP forwarding,Subnet, and public and private IPv4 and IPv6 IP configurations. For more information about IP configurations and how to add and remove IP addresses, seeConfigure IP addresses for an Azure network interface.

SelectDNS serversin the left navigation, and on theDNS serverspage, view any DNS server that Azure DHCP assigns the NIC to. Also note whether the NIC inherits the setting from the virtual network or has a custom setting that overrides the virtual network setting.
SelectDNS serversin the left navigation, and on theDNS serverspage, view any DNS server that Azure DHCP assigns the NIC to. Also note whether the NIC inherits the setting from the virtual network or has a custom setting that overrides the virtual network setting.

SelectNetwork security groupfrom the left navigation, and on theNetwork security grouppage, see any NSG that's associated to the NIC. An NSG contains inbound and outbound rules to filter network traffic for the NIC.
SelectNetwork security groupfrom the left navigation, and on theNetwork security grouppage, see any NSG that's associated to the NIC. An NSG contains inbound and outbound rules to filter network traffic for the NIC.

SelectPropertiesin the left navigation. On thePropertiespage, view settings for the NIC, such as the MAC address and subscription information. The MAC address is blank if the NIC isn't attached to a VM.
SelectPropertiesin the left navigation. On thePropertiespage, view settings for the NIC, such as the MAC address and subscription information. The MAC address is blank if the NIC isn't attached to a VM.

SelectEffective security rulesin the left navigation. TheEffective security rulespage lists security rules if the NIC is attached to a running VM and associated with an NSG. For more information about NSGs, seeNetwork security groups.
SelectEffective security rulesin the left navigation. TheEffective security rulespage lists security rules if the NIC is attached to a running VM and associated with an NSG. For more information about NSGs, seeNetwork security groups.

SelectEffective routesin the left navigation. TheEffective routespage lists routes if the NIC is attached to a running VM.The routes are a combination of the Azure default routes, any user-defined routes, and any Border Gateway Protocol (BGP) routes that exist for the subnet the NIC is assigned to. For more information about Azure default routes and user-defined routes, seeVirtual network traffic routing.
SelectEffective routesin the left navigation. TheEffective routespage lists routes if the NIC is attached to a running VM.
The routes are a combination of the Azure default routes, any user-defined routes, and any Border Gateway Protocol (BGP) routes that exist for the subnet the NIC is assigned to. For more information about Azure default routes and user-defined routes, seeVirtual network traffic routing.

Useaz network nic listto view all NICs in the subscription.
az network nic list
az network nic list
Useaz network nic showto view the settings for a NIC.
az network nic show --name myNIC --resource-group myResourceGroup
az network nic show --name myNIC --resource-group myResourceGroup
UseGet-AzNetworkInterfaceto view NICs in the subscription or view settings for a NIC.
Note
Remove the-Nameand-ResourceGroupNameparameters to return all the NICs in the subscription.
-Name
-ResourceGroupName
Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup
Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup
Change network interface settings
You can change most settings for a NIC after you create it.

Add or change DNS servers
Azure DHCP assigns the DNS server to the NIC within the VM operating system. The NIC can inherit the settings from the virtual network, or use its own unique settings that override the setting for the virtual network. For more information about name resolution settings for a NIC, seeName resolution for virtual machines.
Portal
Azure CLI
PowerShell
In theAzure portal, search for and selectNetwork interfaces.
In theAzure portal, search for and selectNetwork interfaces.
On theNetwork interfacespage, select the NIC you want to change from the list.
On theNetwork interfacespage, select the NIC you want to change from the list.
On the NIC's page, selectDNS serversfrom the left navigation.
On the NIC's page, selectDNS serversfrom the left navigation.
On theDNS serverspage, select one of the following settings:Inherit from virtual network: Choose this option to inherit the DNS server setting from the virtual network the NIC is assigned to. Either a custom DNS server or the Azure-provided DNS server is defined at the virtual network level.The Azure-provided DNS server can resolve hostnames for resources assigned to the same virtual network. The fully qualified domain name (FQDN) must be used for resources assigned to different virtual networks.NoteIf a VM uses a NIC that's part of an availability set, the DNS servers for all NICs for all VMs that are part of the availability set are inherited.Custom: You can configure your own DNS server to resolve names across multiple virtual networks. Enter the IP address of the server you want to use as a DNS server. The DNS server address you specify is assigned only to this NIC and overrides any DNS setting for the virtual network the NIC is assigned to.
On theDNS serverspage, select one of the following settings:
Inherit from virtual network: Choose this option to inherit the DNS server setting from the virtual network the NIC is assigned to. Either a custom DNS server or the Azure-provided DNS server is defined at the virtual network level.The Azure-provided DNS server can resolve hostnames for resources assigned to the same virtual network. The fully qualified domain name (FQDN) must be used for resources assigned to different virtual networks.NoteIf a VM uses a NIC that's part of an availability set, the DNS servers for all NICs for all VMs that are part of the availability set are inherited.
Inherit from virtual network: Choose this option to inherit the DNS server setting from the virtual network the NIC is assigned to. Either a custom DNS server or the Azure-provided DNS server is defined at the virtual network level.
The Azure-provided DNS server can resolve hostnames for resources assigned to the same virtual network. The fully qualified domain name (FQDN) must be used for resources assigned to different virtual networks.
Note
If a VM uses a NIC that's part of an availability set, the DNS servers for all NICs for all VMs that are part of the availability set are inherited.
Custom: You can configure your own DNS server to resolve names across multiple virtual networks. Enter the IP address of the server you want to use as a DNS server. The DNS server address you specify is assigned only to this NIC and overrides any DNS setting for the virtual network the NIC is assigned to.
Custom: You can configure your own DNS server to resolve names across multiple virtual networks. Enter the IP address of the server you want to use as a DNS server. The DNS server address you specify is assigned only to this NIC and overrides any DNS setting for the virtual network the NIC is assigned to.
SelectSave.
SelectSave.
Useaz network nic updateto change the DNS server setting from inherited to a custom setting. Replace the DNS server IP addresses with your custom IP addresses.
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --dns-servers 192.168.1.100 192.168.1.101
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --dns-servers 192.168.1.100 192.168.1.101
To remove the DNS servers and change the setting to virtual network setting inheritance, use the following command:
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --dns-servers null
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --dns-servers null
UseSet-AzNetworkInterfaceto change the DNS server setting from inherited to a custom setting. Replace the DNS server IP addresses with your custom IP addresses.
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Add the DNS servers to the configuration. ##
$nic.DnsSettings.DnsServers.Add("192.168.1.100")

## Add a secondary DNS server if needed, otherwise set the configuration. ##
$nic.DnsSettings.DnsServers.Add("192.168.1.101")

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Add the DNS servers to the configuration. ##
$nic.DnsSettings.DnsServers.Add("192.168.1.100")

## Add a secondary DNS server if needed, otherwise set the configuration. ##
$nic.DnsSettings.DnsServers.Add("192.168.1.101")

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
To remove the DNS servers and change the setting to inherit from the virtual network, use the following command. Replace the DNS server IP addresses with your custom IP addresses.
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Add the DNS servers to the configuration. ##
$nic.DnsSettings.DnsServers.Remove("192.168.1.100")

## Add a secondary DNS server if needed, otherwise set the configuration. ##
$nic.DnsSettings.DnsServers.Remove("192.168.1.101")

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Add the DNS servers to the configuration. ##
$nic.DnsSettings.DnsServers.Remove("192.168.1.100")

## Add a secondary DNS server if needed, otherwise set the configuration. ##
$nic.DnsSettings.DnsServers.Remove("192.168.1.101")

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
Enable or disable IP forwarding
IP forwarding enables a NIC attached to a VM to:
Receive network traffic not destined for any of the IP addresses assigned in any of the NIC's IP configurations.
Send network traffic with a different source IP address than is assigned in any of the NIC's IP configurations.
You must enable IP forwarding for every NIC attached to the VM that needs to forward traffic. A VM can forward traffic whether it has multiple NICs or a single NIC attached to it.
IP forwarding is typically used with user-defined routes. For more information, seeUser-defined routes.
While IP forwarding is an Azure setting, the VM must also run an application that's able to forward the traffic, such as a firewall, WAN optimization, or load balancing application. A VM that runs network applications is often called a network virtual appliance (NVA). You can view a list of ready-to-deploy NVAs in theAzure Marketplace.
Portal
Azure CLI
PowerShell
On the NIC's page, selectIP configurationsin the left navigation.
On theIP configurationspage, underIP forwarding settings, selectEnabledorDisabled, the default, to change the setting.
SelectSave.
Useaz network nic updateto enable or disable the IP forwarding setting.
To enable IP forwarding, use the following command:
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --ip-forwarding true
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --ip-forwarding true
To disable IP forwarding, use the following command:
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --ip-forwarding false
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --ip-forwarding false
UseSet-AzNetworkInterfaceto enable or disable the IP forwarding setting.
To enable IP forwarding, use the following command:
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Set the IP forwarding setting to enabled. ##
$nic.EnableIPForwarding = 1

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Set the IP forwarding setting to enabled. ##
$nic.EnableIPForwarding = 1

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
To disable IP forwarding, use the following command:
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Set the IP forwarding setting to disabled. ##
$nic.EnableIPForwarding = 0

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Set the IP forwarding setting to disabled. ##
$nic.EnableIPForwarding = 0

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
Change subnet assignment
You can change the subnet, but not the virtual network, that a NIC is assigned to.
Portal
Azure CLI
PowerShell
On the NIC's page, selectIP configurationsin the left navigation.
On the NIC's page, selectIP configurationsin the left navigation.
On theIP configurationspage, underIP configurations, if any private IP addresses listed have(Static)next to them, change the IP address assignment method to dynamic. All private IP addresses must be assigned with the dynamic assignment method to change the subnet assignment for the NIC.To change the assignment method to dynamic:Select the IP configuration you want to change from the list of IP configurations.On the IP configuration page, selectDynamicunderAssignment.SelectSave.
On theIP configurationspage, underIP configurations, if any private IP addresses listed have(Static)next to them, change the IP address assignment method to dynamic. All private IP addresses must be assigned with the dynamic assignment method to change the subnet assignment for the NIC.
To change the assignment method to dynamic:
Select the IP configuration you want to change from the list of IP configurations.
On the IP configuration page, selectDynamicunderAssignment.
SelectSave.
When all private IP addresses are set toDynamic, underSubnet, select the subnet you want to move the NIC to.
When all private IP addresses are set toDynamic, underSubnet, select the subnet you want to move the NIC to.
SelectSave. New dynamic addresses are assigned from the new subnet's address range.
SelectSave. New dynamic addresses are assigned from the new subnet's address range.
After assigning the NIC to a new subnet, you can assign a static IPv4 address from the new subnet address range if you choose. For more information about adding, changing, and removing IP addresses for a NIC, seeConfigure IP addresses for an Azure network interface.
Useaz network nic ip-config updateto change the subnet of the NIC.
az network nic ip-config update \
    --name ipv4config \
    --nic-name myNIC \
    --resource-group myResourceGroup \
    --subnet mySubnet \
    --vnet-name myVNet
az network nic ip-config update \
    --name ipv4config \
    --nic-name myNIC \
    --resource-group myResourceGroup \
    --subnet mySubnet \
    --vnet-name myVNet
UseSet-AzNetworkInterfaceIpConfigto change the subnet of the NIC.
## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Change the subnet in the IP configuration. Replace the subnet number with number of your subnet in your VNet. Your first listed subnet in your VNet is 0, next is 1, and so on. ##
$IP = @{
    Name = 'ipv4config'
    Subnet = $vnet.Subnets[1]
}
$nic | Set-AzNetworkInterfaceIpConfig @IP

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Change the subnet in the IP configuration. Replace the subnet number with number of your subnet in your VNet. Your first listed subnet in your VNet is 0, next is 1, and so on. ##
$IP = @{
    Name = 'ipv4config'
    Subnet = $vnet.Subnets[1]
}
$nic | Set-AzNetworkInterfaceIpConfig @IP

## Apply the new configuration to the network interface. ##
$nic | Set-AzNetworkInterface
Warning
You can change the subnet of a primary network interface while the virtual machine is started. You can't change the subnet of a secondary network interface in the same manner. To change the subnet of a secondary network interface, you must first stop and de-allocate the virtual machine.
Add or remove from application security groups
You can add NICs only to application security groups in the same virtual network and location as the NIC.
You can use the portal to add or remove a NIC for an application security group only if the NIC is attached to a VM. Otherwise, use PowerShell or Azure CLI. For more information, seeApplication security groupsandHow to create an application security group.
Portal
Azure CLI
PowerShell
To add or remove a NIC for an application security group on a VM, follow this procedure:
In theAzure portal, search for and selectvirtual machines.
In theAzure portal, search for and selectvirtual machines.
On theVirtual machinespage, select the VM you want to configure from the list.
On theVirtual machinespage, select the VM you want to configure from the list.
On the VM's page, selectNetworkingfrom the left navigation.
On the VM's page, selectNetworkingfrom the left navigation.
On theNetworkingpage, under theApplication security groupstab, selectConfigure the application security groups.
On theNetworkingpage, under theApplication security groupstab, selectConfigure the application security groups.

Select the application security groups you want to add the NIC to, or deselect the application security groups you want to remove the NIC from.
Select the application security groups you want to add the NIC to, or deselect the application security groups you want to remove the NIC from.
SelectSave.
SelectSave.
Useaz network nic ip-config updateto set the application security group.
az network nic ip-config update \
    --name ipv4config \
    --nic-name myNIC \
    --resource-group myResourceGroup \
    --application-security-groups myASG
az network nic ip-config update \
    --name ipv4config \
    --nic-name myNIC \
    --resource-group myResourceGroup \
    --application-security-groups myASG
UseSet-AzNetworkInterfaceIpConfigto set the application security group.
## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the subnet configuration into a variable. ##
$subnet = Get-AzVirtualNetworkSubnetConfig -Name mySubnet -VirtualNetwork $vnet

## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Place the application security group configuration into a variable. ##
$asg = Get-AzApplicationSecurityGroup -Name myASG -ResourceGroupName myResourceGroup

## Add the application security group to the IP configuration. ##
$IP = @{
    Name = 'ipv4config'
    Subnet = $subnet
    ApplicationSecurityGroup = $asg
}
$nic | Set-AzNetworkInterfaceIpConfig @IP

## Save the configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the virtual network into a variable. ##
$net = @{
    Name = 'myVNet'
    ResourceGroupName = 'myResourceGroup'
}
$vnet = Get-AzVirtualNetwork @net

## Place the subnet configuration into a variable. ##
$subnet = Get-AzVirtualNetworkSubnetConfig -Name mySubnet -VirtualNetwork $vnet

## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Place the application security group configuration into a variable. ##
$asg = Get-AzApplicationSecurityGroup -Name myASG -ResourceGroupName myResourceGroup

## Add the application security group to the IP configuration. ##
$IP = @{
    Name = 'ipv4config'
    Subnet = $subnet
    ApplicationSecurityGroup = $asg
}
$nic | Set-AzNetworkInterfaceIpConfig @IP

## Save the configuration to the network interface. ##
$nic | Set-AzNetworkInterface
Associate or dissociate a network security group
Portal
Azure CLI
PowerShell
On the NIC's page, selectNetwork security groupin the left navigation.
On theNetwork security grouppage, select the network security group you want to associate, or selectNoneto dissociate the NSG.
SelectSave.
Useaz network nic updateto set the network security group for the NIC.
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --network-security-group myNSG
az network nic update \
    --name myNIC \
    --resource-group myResourceGroup \
    --network-security-group myNSG
UseSet-AzNetworkInterfaceto set the network security group for the NIC.
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Place the network security group configuration into a variable. ##
$nsg = Get-AzNetworkSecurityGroup -Name myNSG -ResourceGroupName myResourceGroup

## Add the NSG to the NIC configuration. ##
$nic.NetworkSecurityGroup = $nsg

## Save the configuration to the network interface. ##
$nic | Set-AzNetworkInterface
## Place the network interface configuration into a variable. ##
$nic = Get-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup

## Place the network security group configuration into a variable. ##
$nsg = Get-AzNetworkSecurityGroup -Name myNSG -ResourceGroupName myResourceGroup

## Add the NSG to the NIC configuration. ##
$nic.NetworkSecurityGroup = $nsg

## Save the configuration to the network interface. ##
$nic | Set-AzNetworkInterface
Delete a network interface
You can delete a NIC if it's not attached to a VM. If the NIC is attached to a VM, you must first stop and deallocate the VM, then detach the NIC.
To detach the NIC from the VM, complete the steps inRemove a network interface from a VM. A VM must always have at least one NIC attached to it, so you can't delete the only NIC from a VM.
Portal
Azure CLI
PowerShell
To delete a NIC, on theOverviewpage for the NIC you want to delete, selectDeletefrom the top menu bar, and then selectYes.
Useaz network nic deleteto delete the NIC.
az network nic delete --name myNIC --resource-group myResourceGroup
az network nic delete --name myNIC --resource-group myResourceGroup
UseRemove-AzNetworkInterfaceto delete the NIC.
Remove-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup
Remove-AzNetworkInterface -Name myNIC -ResourceGroupName myResourceGroup
Resolve connectivity issues
If you have communication problems with a VM, network security group rules or effective routes might be causing the problems. Use the following options to help resolve the issue.
View effective security rules
The effective security rules for each NIC attached to a VM are a combination of the rules you created in an NSG anddefault security rules. Understanding the effective security rules for a NIC might help you determine why you're unable to communicate to or from a VM. You can view the effective rules for any NIC that's attached to a running VM.
Portal
Azure CLI
PowerShell
In theAzure portal, search for and selectvirtual machines.
On theVirtual machinespage, select the VM you want to view settings for.
On the VM page, selectNetworkingfrom the left navigation.
On theNetworkingpage, select theNetwork Interface.
On the NIC's page, selectEffective security rulesunderHelpin the left navigation.
Review the list of effective security rules to determine if the rules are correct for your required inbound and outbound communications. For more information about security rules, seeNetwork security group overview.
Useaz network nic list-effective-nsgto view the list of effective security rules.
az network nic list-effective-nsg --name myNIC --resource-group myResourceGroup
az network nic list-effective-nsg --name myNIC --resource-group myResourceGroup
UseGet-AzEffectiveNetworkSecurityGroupto view the list of effective security rules.
Get-AzEffectiveNetworkSecurityGroup -NetworkInterfaceName myNIC -ResourceGroupName myResourceGroup
Get-AzEffectiveNetworkSecurityGroup -NetworkInterfaceName myNIC -ResourceGroupName myResourceGroup
View effective routes
The effective routes for the NIC or NICs attached to a VM are a combination of:
Default routes
User-defined routes
Routes propagated from on-premises networks via BGP through an Azure virtual network gateway.
Understanding the effective routes for a NIC might help you determine why you can't communicate with a VM. You can view the effective routes for any NIC that's attached to a running VM.
Portal
Azure CLI
PowerShell
On the page for the NIC that's attached to the VM, selectEffective routesunderHelpin the left navigation.
Review the list of effective routes to see if the routes are correct for your required inbound and outbound communications. For more information about routing, seeRouting overview.
Useaz network nic show-effective-route-tableto view a list of the effective routes.
az network nic show-effective-route-table --name myNIC --resource-group myResourceGroup
az network nic show-effective-route-table --name myNIC --resource-group myResourceGroup
UseGet-AzEffectiveRouteTableto view a list of the effective routes.
Get-AzEffectiveRouteTable -NetworkInterfaceName myNIC -ResourceGroupName myResourceGroup
Get-AzEffectiveRouteTable -NetworkInterfaceName myNIC -ResourceGroupName myResourceGroup
The next hop feature of Azure Network Watcher can also help you determine if routes are preventing communication between a VM and an endpoint. For more information, seeTutorial: Diagnose a virtual machine network routing problem by using the Azure portal.
Next steps
For other network interface tasks, see the following articles:
Feedback
Was this page helpful?
Additional resources